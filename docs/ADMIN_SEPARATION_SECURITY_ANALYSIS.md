# üîê –ê–Ω–∞–ª–∏–∑ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –∞–¥–º–∏–Ω–∫–∏

## ‚úÖ –¢–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –£–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:

1. **–°–µ—Å—Å–∏–∏**
   - ‚úÖ `httpOnly: true` - –∑–∞—â–∏—Ç–∞ –æ—Ç XSS
   - ‚úÖ `sameSite: 'lax'` - –∑–∞—â–∏—Ç–∞ –æ—Ç CSRF
   - ‚úÖ `secure: true` –≤ –ø—Ä–æ–¥–µ - —Ç–æ–ª—å–∫–æ HTTPS
   - ‚úÖ –•—Ä–∞–Ω–µ–Ω–∏–µ –≤ PostgreSQL (–Ω–µ –≤ –ø–∞–º—è—Ç–∏)
   - ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –∏—Å—Ç–µ–∫—à–∏—Ö —Å–µ—Å—Å–∏–π

2. **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∞–¥–º–∏–Ω–∞**
   - ‚úÖ –û—Ç–¥–µ–ª—å–Ω—ã–π middleware `requireAdmin`
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ `isActive` —Å—Ç–∞—Ç—É—Å–∞
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ —á–µ—Ä–µ–∑ `requirePermission`
   - ‚úÖ –†–æ–ª–∏ (super_admin –∏–º–µ–µ—Ç –≤—Å–µ –ø—Ä–∞–≤–∞)
   - ‚úÖ IP whitelist (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –≤ –∫–æ–¥–µ –µ—Å—Ç—å)

3. **Rate Limiting**
   - ‚úÖ 5 –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞ / 15 –º–∏–Ω—É—Ç
   - ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç brute-force –∞—Ç–∞–∫

4. **Security Headers**
   - ‚úÖ Helmet —Å –∑–∞—â–∏—Ç–æ–π –æ—Ç clickjacking
   - ‚úÖ CSP (Content Security Policy)
   - ‚úÖ XSS Protection

5. **–ê—É–¥–∏—Ç**
   - ‚úÖ –í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –∞–¥–º–∏–Ω–æ–≤ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è
   - ‚úÖ –ò—Å—Ç–æ—Ä–∏—è –≤—Ö–æ–¥–æ–≤/–≤—ã—Ö–æ–¥–æ–≤

---

## ‚ö†Ô∏è –†–∏—Å–∫–∏ –ø—Ä–∏ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–∏

### –ù–∏–∑–∫–∏–π —Ä–∏—Å–∫:

1. **–û–±—â–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**
   - ‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ**: –û–±–∞ –ø—Ä–æ–µ–∫—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–¥–Ω—É –ë–î, –Ω–æ:
     - –û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ–µ–∫—Ç: –¥–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º —Ç–∞–±–ª–∏—Ü–∞–º
     - –ê–¥–º–∏–Ω-–ø—Ä–æ–µ–∫—Ç: –¥–æ—Å—Ç—É–ø –∫ –∞–¥–º–∏–Ω—Å–∫–∏–º —Ç–∞–±–ª–∏—Ü–∞–º (`admin_users`, `admin_audit_log`)
   - ‚úÖ Middleware –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –∏–∑–æ–ª—è—Ü–∏—é (–∞–¥–º–∏–Ω—ã –Ω–µ –º–æ–≥—É—Ç –≤–æ–π—Ç–∏ –≤ –æ—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ–µ–∫—Ç –∏ –Ω–∞–æ–±–æ—Ä–æ—Ç)
   - ‚ö†Ô∏è **–†–∏—Å–∫**: –ï—Å–ª–∏ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω –∞–¥–º–∏–Ω-—Å–µ—Ä–≤–µ—Ä, –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø –∫ –ë–î
   - ‚úÖ **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ë–î (read-only –¥–ª—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ)

2. **–°–µ—Å—Å–∏–∏ –≤ –æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ**
   - ‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ**: –°–µ—Å—Å–∏–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ `session`, –Ω–æ:
     - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏: `req.session.userId` –∏–ª–∏ `req.session.passport.user`
     - –ê–¥–º–∏–Ω—ã: `req.session.adminId`
   - ‚úÖ –†–∞–∑–Ω—ã–µ –ø–æ–ª—è = –∏–∑–æ–ª—è—Ü–∏—è
   - ‚ö†Ô∏è **–†–∏—Å–∫**: –ï—Å–ª–∏ —É—Ç–µ—á–∫–∞ `SESSION_SECRET`, –º–æ–∂–Ω–æ –ø–æ–¥–¥–µ–ª–∞—Ç—å –æ–±–µ —Å–µ—Å—Å–∏–∏
   - ‚úÖ **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ `SESSION_SECRET` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞

### –°—Ä–µ–¥–Ω–∏–π —Ä–∏—Å–∫:

3. **CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏**
   - ‚ö†Ô∏è **–†–∏—Å–∫**: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ CORS = —É—Ç–µ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö
   - ‚úÖ **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: 
     ```typescript
     // –ê–¥–º–∏–Ω-—Å–µ—Ä–≤–µ—Ä
     cors({
       origin: process.env.ADMIN_FRONTEND_URL, // –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω-–¥–æ–º–µ–Ω
       credentials: true,
     })
     ```

4. **–î–≤–∞ –º–µ—Å—Ç–∞ –¥–ª—è –∞—Ç–∞–∫–∏**
   - ‚ö†Ô∏è **–†–∏—Å–∫**: –î–≤–∞ —Å–µ—Ä–≤–µ—Ä–∞ = –¥–≤–∞ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –≤–µ–∫—Ç–æ—Ä–∞ –∞—Ç–∞–∫–∏
   - ‚úÖ **–ü–ª—é—Å**: –ï—Å–ª–∏ –æ–¥–∏–Ω —É–ø–∞–¥–µ—Ç, –¥—Ä—É–≥–æ–π —Ä–∞–±–æ—Ç–∞–µ—Ç
   - ‚úÖ **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: 
     - –†–∞–∑–Ω—ã–µ –¥–æ–º–µ–Ω—ã/IP
     - –ê–¥–º–∏–Ω-—Å–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –∏–∑ VPN/whitelist IP
     - –†–∞–∑–Ω—ã–µ credentials

5. **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–æ–¥–∞**
   - ‚ö†Ô∏è **–†–∏—Å–∫**: –û–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤ `shared/` –º–æ–≥—É—Ç —Å–ª–æ–º–∞—Ç—å –æ–¥–∏–Ω –∏–∑ –ø—Ä–æ–µ–∫—Ç–æ–≤
   - ‚úÖ **–ú–∏—Ç–∏–≥–∞—Ü–∏—è**: –¢–µ—Å—Ç—ã –¥–ª—è –æ–±–æ–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤

### –í—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫ (—Ç—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è):

6. **–û–±—â–∏–π SESSION_SECRET**
   - ‚ùå **–û–ü–ê–°–ù–û**: –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–∏–Ω `SESSION_SECRET`:
     - –°–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–¥–º–∏–Ω-—Å–µ—Ä–≤–µ—Ä = –¥–æ—Å—Ç—É–ø –∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º —Å–µ—Å—Å–∏—è–º
     - –°–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–µ—Ä = –¥–æ—Å—Ç—É–ø –∫ –∞–¥–º–∏–Ω—Å–∫–∏–º —Å–µ—Å—Å–∏—è–º
   - ‚úÖ **–†–ï–®–ï–ù–ò–ï**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **—Ä–∞–∑–Ω—ã–µ** `SESSION_SECRET`:
     ```env
     # –û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ–µ–∫—Ç
     SESSION_SECRET=main_app_secret_here
     
     # –ê–¥–º–∏–Ω-–ø—Ä–æ–µ–∫—Ç
     SESSION_SECRET=admin_panel_secret_here
     ```

---

## üõ°Ô∏è –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ:

1. **–†–∞–∑–Ω—ã–µ SESSION_SECRET**
   ```bash
   # –û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ–µ–∫—Ç
   openssl rand -base64 32  # ‚Üí SESSION_SECRET –¥–ª—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ
   
   # –ê–¥–º–∏–Ω-–ø—Ä–æ–µ–∫—Ç  
   openssl rand -base64 32  # ‚Üí SESSION_SECRET –¥–ª—è –∞–¥–º–∏–Ω–∫–∏
   ```

2. **–°—Ç—Ä–æ–≥–∏–π CORS –¥–ª—è –∞–¥–º–∏–Ω–∫–∏**
   ```typescript
   // –¢–æ–ª—å–∫–æ –æ–¥–∏–Ω –¥–æ–º–µ–Ω!
   cors({
     origin: 'https://admin.yourdomain.com',
     credentials: true,
   })
   ```

3. **IP Whitelist –¥–ª—è –∞–¥–º–∏–Ω-—Å–µ—Ä–≤–µ—Ä–∞**
   ```nginx
   # Nginx - —Ä–∞–∑—Ä–µ—à–∏—Ç—å –¥–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö IP
   allow 1.2.3.4;  # –í–∞—à IP
   allow 5.6.7.8;  # –û—Ñ–∏—Å IP
   deny all;
   ```

4. **Firewall –ø—Ä–∞–≤–∏–ª–∞**
   ```bash
   # –ê–¥–º–∏–Ω-—Å–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –∏–∑ VPN/whitelist
   ufw allow from 1.2.3.4 to any port 3001
   ufw deny 3001
   ```

5. **–†–∞–∑–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ë–î (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)**
   ```sql
   -- –û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ–µ–∫—Ç: read-write, –Ω–æ —Ç–æ–ª—å–∫–æ –∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º —Ç–∞–±–ª–∏—Ü–∞–º
   CREATE USER main_app WITH PASSWORD '...';
   GRANT SELECT, INSERT, UPDATE, DELETE ON users, transactions, ... TO main_app;
   
   -- –ê–¥–º–∏–Ω-–ø—Ä–æ–µ–∫—Ç: read-write –∫–æ –≤—Å–µ–º —Ç–∞–±–ª–∏—Ü–∞–º
   CREATE USER admin_app WITH PASSWORD '...';
   GRANT ALL ON ALL TABLES IN SCHEMA public TO admin_app;
   ```

6. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**
   - ‚úÖ Sentry –¥–ª—è –æ–±–æ–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤
   - ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –≤—Ö–æ–¥–æ–≤ –∞–¥–º–∏–Ω–æ–≤
   - ‚úÖ –ê–ª–µ—Ä—Ç—ã –Ω–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å

### –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ (—É—Å–∏–ª–µ–Ω–∏–µ):

7. **2FA –¥–ª—è –∞–¥–º–∏–Ω–æ–≤**
   - –£–∂–µ –µ—Å—Ç—å –±–∞–∑–∞ –≤ –∫–æ–¥–µ (two-factor authentication)
   - –í–∫–ª—é—á–∏—Ç—å –¥–ª—è –≤—Å–µ—Ö –∞–¥–º–∏–Ω–æ–≤

8. **–û—Ç–¥–µ–ª—å–Ω–∞—è —Å–µ—Ç—å –¥–ª—è –∞–¥–º–∏–Ω–∫–∏**
   - VPN –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∞–¥–º–∏–Ω-—Å–µ—Ä–≤–µ—Ä—É
   - –ò–ª–∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è —Å–µ—Ç—å

9. **WAF (Web Application Firewall)**
   - Cloudflare –¥–ª—è –æ–±–æ–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤
   - –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç DDoS

10. **–†–µ–≥—É–ª—è—Ä–Ω—ã–µ –∞—É–¥–∏—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ –∞–¥–º–∏–Ω–∫–∏
    - –ê–Ω–∞–ª–∏–∑ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
    - –ü–µ–Ω—Ç–µ—Å—Ç—ã

---

## üìä –ò—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –î–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è: **7/10**
- ‚úÖ –•–æ—Ä–æ—à–∞—è –±–∞–∑–æ–≤–∞—è –∑–∞—â–∏—Ç–∞
- ‚ö†Ô∏è –í—Å–µ —è–π—Ü–∞ –≤ –æ–¥–Ω–æ–π –∫–æ—Ä–∑–∏–Ω–µ
- ‚ö†Ô∏è –ü–∞–¥–µ–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ = –ø–∞–¥–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∫–∏

### –ü–æ—Å–ª–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è (–±–µ–∑ –º–µ—Ä): **6/10**
- ‚úÖ –ò–∑–æ–ª—è—Ü–∏—è —Å–µ—Ä–≤–µ—Ä–æ–≤
- ‚ùå –û–±—â–∏–π SESSION_SECRET = –ø–æ–≤—ã—à–µ–Ω–Ω—ã–π —Ä–∏—Å–∫
- ‚ùå –î–≤–∞ –º–µ—Å—Ç–∞ –¥–ª—è –∞—Ç–∞–∫–∏

### –ü–æ—Å–ª–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è (—Å –º–µ—Ä–∞–º–∏): **9/10**
- ‚úÖ –ò–∑–æ–ª—è—Ü–∏—è —Å–µ—Ä–≤–µ—Ä–æ–≤
- ‚úÖ –†–∞–∑–Ω—ã–µ SESSION_SECRET
- ‚úÖ IP Whitelist –¥–ª—è –∞–¥–º–∏–Ω–∫–∏
- ‚úÖ –°—Ç—Ä–æ–≥–∏–π CORS
- ‚úÖ –†–∞–∑–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ë–î
- ‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- ‚ö†Ô∏è –î–≤–∞ –º–µ—Å—Ç–∞ –¥–ª—è –∞—Ç–∞–∫–∏ (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ)

---

## ‚è±Ô∏è –û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π (4-6 —á–∞—Å–æ–≤)
**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è:**
- –£–¥–∞–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∫–∏ –∏–∑ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
- –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∞–¥–º–∏–Ω-–ø—Ä–æ–µ–∫—Ç–∞
- –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –∏ –±–∞–∑–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—É—Ç–µ–π
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ

**–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** 6/10 (–æ–±—â–∏–π SESSION_SECRET, –±–∞–∑–æ–≤—ã–π CORS)

**–ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è:**
- –¢–µ—Å—Ç–æ–≤–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–≥–æ —ç—Ç–∞–ø–∞

---

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ü–æ–ª–Ω—ã–π (8-12 —á–∞—Å–æ–≤)
**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è:**
- –í—Å–µ –∏–∑ –≤–∞—Ä–∏–∞–Ω—Ç–∞ 1
- –†–∞–∑–Ω—ã–µ SESSION_SECRET
- –°—Ç—Ä–æ–≥–∏–π CORS
- –†–∞–∑–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ë–î
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–µ–ø–ª–æ—è (–¥–≤–∞ —Å–µ—Ä–≤–µ—Ä–∞)
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –ø—Ä–æ–¥–µ

**–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** 8/10

**–ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è:**
- Production –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –°–µ—Ä—å–µ–∑–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤

---

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (12-16 —á–∞—Å–æ–≤)
**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è:**
- –í—Å–µ –∏–∑ –≤–∞—Ä–∏–∞–Ω—Ç–∞ 2
- IP Whitelist (Nginx/Firewall)
- 2FA –¥–ª—è –≤—Å–µ—Ö –∞–¥–º–∏–Ω–æ–≤
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–ª–µ—Ä—Ç—ã
- –ê—É–¥–∏—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –ü–µ–Ω—Ç–µ—Å—Ç—ã
- –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ—Å—Å–∏–π

**–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** 9/10

**–ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è:**
- –ö—Ä–∏—Ç–∏—á–Ω—ã—Ö —Å–∏—Å—Ç–µ–º
- –ë–æ–ª—å—à–∏—Ö –∫–æ–º–ø–∞–Ω–∏–π
- –§–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π

---

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è

### –î–ª—è –≤–∞—à–µ–≥–æ —Å–ª—É—á–∞—è: **–í–∞—Ä–∏–∞–Ω—Ç 2 (8-12 —á–∞—Å–æ–≤)**

**–ü–æ—á–µ–º—É:**
1. ‚úÖ –ë–∞–ª–∞–Ω—Å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –≤—Ä–µ–º–µ–Ω–∏
2. ‚úÖ –î–æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è –∑–∞—â–∏—Ç–∞ –¥–ª—è production
3. ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã (VPN)
4. ‚úÖ –ú–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –∑–∞ 1-2 —Ä–∞–±–æ—á–∏—Ö –¥–Ω—è

**–ß—Ç–æ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ:**
- ‚úÖ –†–∞–∑–Ω—ã–µ SESSION_SECRET
- ‚úÖ –°—Ç—Ä–æ–≥–∏–π CORS
- ‚úÖ IP Whitelist –¥–ª—è –∞–¥–º–∏–Ω–∫–∏ (—á–µ—Ä–µ–∑ Nginx)
- ‚úÖ –†–∞–∑–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ë–î
- ‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

**–ß—Ç–æ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–∑–∂–µ:**
- ‚è±Ô∏è 2FA (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
- ‚è±Ô∏è VPN (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
- ‚è±Ô∏è WAF (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

---

## ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ:

- [ ] –†–∞–∑–Ω—ã–µ `SESSION_SECRET` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
- [ ] CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Ç–æ–ª—å–∫–æ –Ω–∞ –∞–¥–º–∏–Ω-–¥–æ–º–µ–Ω
- [ ] IP Whitelist —á–µ—Ä–µ–∑ Nginx/Firewall –¥–ª—è –∞–¥–º–∏–Ω–∫–∏
- [ ] HTTPS –≤–∫–ª—é—á–µ–Ω –¥–ª—è –æ–±–æ–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤
- [ ] Security headers (helmet) –≤–∫–ª—é—á–µ–Ω—ã
- [ ] Rate limiting —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –ê—É–¥–∏—Ç –ª–æ–≥–∏ –≤–∫–ª—é—á–µ–Ω—ã
- [ ] –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–∞—Å—Ç—Ä–æ–µ–Ω (Sentry)
- [ ] –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ë–î —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –¢–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã –¥–ª—è –æ–±–æ–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:

- [ ] –†–∞–∑–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ë–î (–µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ)
- [ ] 2FA –¥–ª—è –∞–¥–º–∏–Ω–æ–≤
- [ ] –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ª–æ–≥–æ–≤
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

---

## üö® –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ (–∏–∑–±–µ–≥–∞—Ç—å!)

1. ‚ùå **–û–¥–∏–Ω SESSION_SECRET** –¥–ª—è –æ–±–æ–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤
2. ‚ùå **CORS: `origin: '*'`** (–æ—Ç–∫—Ä—ã—Ç –≤—Å–µ–º)
3. ‚ùå **–ê–¥–º–∏–Ω-—Å–µ—Ä–≤–µ—Ä –±–µ–∑ IP Whitelist** (–æ—Ç–∫—Ä—ã—Ç –≤—Å–µ–º –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ)
4. ‚ùå **HTTP –≤–º–µ—Å—Ç–æ HTTPS** –¥–ª—è –∞–¥–º–∏–Ω–∫–∏
5. ‚ùå **–ù–µ—Ç rate limiting** –Ω–∞ –∞–¥–º–∏–Ω-–≤—Ö–æ–¥
6. ‚ùå **–ù–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞** –∞–¥–º–∏–Ω–∫–∏
7. ‚ùå **–û–±—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ë–î** —Å –ø–æ–ª–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏ –¥–ª—è –æ–±–æ–∏—Ö

---

## üìö –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [OWASP Top 10](https://owasp.org/www-project-top-ten/)
- [Session Security Best Practices](https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html)
- [CORS Security](https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS)
- [PostgreSQL Security](https://www.postgresql.org/docs/current/security.html)

---

**–ò—Ç–æ–≥:** –ü—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ **–±–µ–∑–æ–ø–∞—Å–Ω–µ–µ** —á–µ–º –µ–¥–∏–Ω—ã–π —Å–µ—Ä–≤–µ—Ä, –ø–æ—Ç–æ–º—É —á—Ç–æ –∏–∑–æ–ª—è—Ü–∏—è —Å–Ω–∏–∂–∞–µ—Ç —Ä–∏—Å–∫–∏. –ù–æ –Ω—É–∂–Ω–æ —Å–æ–±–ª—é–¥–∞—Ç—å –º–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏–∑ —ç—Ç–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞.
