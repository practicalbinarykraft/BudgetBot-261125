# –û—Ç—á–µ—Ç –ø–æ —Ç–µ—Å—Ç–∞–º

**–î–∞—Ç–∞:** 14 —è–Ω–≤–∞—Ä—è 2025  
**–ö–æ–º–∞–Ω–¥–∞:** `npm run test:run`

## –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

- ‚úÖ **–ü—Ä–æ–π–¥–µ–Ω–æ:** 330 —Ç–µ—Å—Ç–æ–≤
- ‚ùå **–£–ø–∞–ª–æ:** 47 —Ç–µ—Å—Ç–æ–≤
- ‚è≠Ô∏è **–ü—Ä–æ–ø—É—â–µ–Ω–æ:** 14 —Ç–µ—Å—Ç–æ–≤
- üìÅ **–§–∞–π–ª–æ–≤ —Ç–µ—Å—Ç–æ–≤:** 36 (27 —É—Å–ø–µ—à–Ω—ã—Ö, 8 —É–ø–∞–≤—à–∏—Ö, 1 –ø—Ä–æ–ø—É—â–µ–Ω)

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** 2.85 —Å–µ–∫—É–Ω–¥

## –£—Å–ø–µ—à–Ω—ã–µ —Ç–µ—Å—Ç—ã (27 —Ñ–∞–π–ª–æ–≤)

‚úÖ **–ö–ª–∏–µ–Ω—Ç—Å–∫–∏–µ —Ç–µ—Å—Ç—ã:**
- `client/src/__tests__/ui-components.test.tsx` (21 —Ç–µ—Å—Ç)
- `client/src/pages/__tests__/auth-page-prompt.test.tsx` (7 —Ç–µ—Å—Ç–æ–≤)
- `client/src/components/auth/__tests__/telegram-link-prompt.test.tsx` (2 –∏–∑ 4 —Ç–µ—Å—Ç–æ–≤)

‚úÖ **–°–µ—Ä–≤–µ—Ä–Ω—ã–µ —Ç–µ—Å—Ç—ã:**
- `server/__tests__/auth.test.ts` (9 —Ç–µ—Å—Ç–æ–≤)
- `server/__tests__/security.test.ts` (14 —Ç–µ—Å—Ç–æ–≤)
- `server/__tests__/performance.test.ts` (8 —Ç–µ—Å—Ç–æ–≤)
- `server/routes/__tests__/password-recovery.routes.test.ts` (14 —Ç–µ—Å—Ç–æ–≤)
- `server/routes/__tests__/auth-telegram.test.ts` (17 —Ç–µ—Å—Ç–æ–≤)
- `server/repositories/__tests__/category.repository.test.ts` (11 —Ç–µ—Å—Ç–æ–≤)
- `server/repositories/__tests__/wallet.repository.test.ts` (7 —Ç–µ—Å—Ç–æ–≤)
- `server/services/__tests__/transaction.service.test.ts` (12 —Ç–µ—Å—Ç–æ–≤)
- `server/services/__tests__/budget.service.test.ts` (16 —Ç–µ—Å—Ç–æ–≤)
- `server/services/__tests__/backup.service.test.ts` (7 —Ç–µ—Å—Ç–æ–≤)
- `server/services/__tests__/currency-service.test.ts` (31 —Ç–µ—Å—Ç)
- `server/services/__tests__/migration.service.test.ts` (20 —Ç–µ—Å—Ç–æ–≤)
- `server/services/__tests__/admin-auth.service.test.ts` (11 —Ç–µ—Å—Ç–æ–≤)
- `server/services/__tests__/admin-broadcasts.service.test.ts` (9 —Ç–µ—Å—Ç–æ–≤)
- `server/services/__tests__/admin-system-health.service.test.ts` (4 —Ç–µ—Å—Ç–∞)
- `server/services/__tests__/admin-support.service.test.ts` (10 —Ç–µ—Å—Ç–æ–≤)
- `server/services/__tests__/admin-metrics.service.test.ts` (6 —Ç–µ—Å—Ç–æ–≤)
- `server/services/__tests__/admin-analytics.service.test.ts` (7 —Ç–µ—Å—Ç–æ–≤)
- `server/services/__tests__/admin-users.service.test.ts` (8 —Ç–µ—Å—Ç–æ–≤)
- `server/services/__tests__/password-reset.service.test.ts` (9 —Ç–µ—Å—Ç–æ–≤, 5 –ø—Ä–æ–ø—É—â–µ–Ω–æ)
- `server/lib/__tests__/encryption.test.ts` (22 —Ç–µ—Å—Ç–∞)
- `server/lib/__tests__/errors.test.ts` (17 —Ç–µ—Å—Ç–æ–≤)
- `server/lib/__tests__/monitoring.test.ts` (12 —Ç–µ—Å—Ç–æ–≤)
- `server/middleware/__tests__/admin-auth.middleware.test.ts` (12 —Ç–µ—Å—Ç–æ–≤)
- `server/middleware/__tests__/rate-limit.test.ts` (8 —Ç–µ—Å—Ç–æ–≤)

## –£–ø–∞–≤—à–∏–µ —Ç–µ—Å—Ç—ã (8 —Ñ–∞–π–ª–æ–≤)

### 1. ‚ùå `client/src/components/auth/__tests__/telegram-login-button.test.tsx`
**–ü—Ä–æ–±–ª–µ–º–∞:** React is not defined  
**–£–ø–∞–ª–æ:** 13 —Ç–µ—Å—Ç–æ–≤ –∏–∑ 13

**–û—à–∏–±–∫–∞:**
```
ReferenceError: React is not defined
```

**–ü—Ä–∏—á–∏–Ω–∞:** –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∏–º–ø–æ—Ä—Ç React –≤ —Ç–µ—Å—Ç–∞—Ö –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π —Ç–µ—Å—Ç–æ–≤–æ–π —Å—Ä–µ–¥—ã.

---

### 2. ‚ùå `client/src/components/settings/__tests__/telegram-account-settings.test.tsx`
**–ü—Ä–æ–±–ª–µ–º–∞:** React is not defined  
**–£–ø–∞–ª–æ:** 16 —Ç–µ—Å—Ç–æ–≤ –∏–∑ 16

**–û—à–∏–±–∫–∞:**
```
ReferenceError: React is not defined
```

**–ü—Ä–∏—á–∏–Ω–∞:** –¢–∞ –∂–µ –ø—Ä–æ–±–ª–µ–º–∞ - –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∏–º–ø–æ—Ä—Ç React.

---

### 3. ‚ùå `client/src/components/auth/__tests__/telegram-link-prompt.test.tsx`
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–æ–±–ª–µ–º—ã —Å —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–æ–º  
**–£–ø–∞–ª–æ:** 2 —Ç–µ—Å—Ç–∞ –∏–∑ 4

**–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è:**
```
useTranslation used outside I18nProvider, using default language
```

**–£–ø–∞–≤—à–∏–µ —Ç–µ—Å—Ç—ã:**
- `should render when open`
- `should call onAccept when "–î–∞, —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å" is clicked`

---

### 4. ‚ùå `client/src/hooks/__tests__/use-telegram-miniapp.test.tsx`
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–æ–±–ª–µ–º—ã —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º Mini App  
**–£–ø–∞–ª–æ:** 1 —Ç–µ—Å—Ç –∏–∑ 4

**–£–ø–∞–≤—à–∏–π —Ç–µ—Å—Ç:**
- `should detect Mini App when Telegram WebApp is available`

---

### 5. ‚ùå `server/services/__tests__/admin-audit-log.service.test.ts`
**–ü—Ä–æ–±–ª–µ–º–∞:** –û—à–∏–±–∫–∞ –º–æ–∫–∏–Ω–≥–∞ –º–æ–¥—É–ª—è  
**–£–ø–∞–ª–æ:** –í–µ—Å—å —Ñ–∞–π–ª –Ω–µ –∑–∞–ø—É—Å—Ç–∏–ª—Å—è

**–û—à–∏–±–∫–∞:**
```
Error: [vitest] There was an error when mocking a module.
ReferenceError: Cannot access 'mockInsert' before initialization
```

**–ü—Ä–∏—á–∏–Ω–∞:** –ü—Ä–æ–±–ª–µ–º–∞ —Å –ø–æ—Ä—è–¥–∫–æ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –º–æ–∫–æ–≤ –≤ —Ç–µ—Å—Ç–µ.

---

### 6. ‚ùå `server/routes/__tests__/telegram-webapp-auth.test.ts`
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–æ–±–ª–µ–º—ã —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π —á–µ—Ä–µ–∑ Telegram WebApp  
**–£–ø–∞–ª–æ:** 4 —Ç–µ—Å—Ç–∞ –∏–∑ 5

**–£–ø–∞–≤—à–∏–µ —Ç–µ—Å—Ç—ã:**
- `should auto-login user when telegram_id is linked and has email+password`
- `should return requiresEmail when user has telegram_id but no email`
- `should return requiresRegistration when telegram_id is not in database`
- `should reject invalid hash`

---

### 7. ‚ùå `server/routes/__tests__/register-miniapp.test.ts`
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–æ–±–ª–µ–º—ã —Å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–µ–π —á–µ—Ä–µ–∑ Mini App  
**–£–ø–∞–ª–æ:** 6 —Ç–µ—Å—Ç–æ–≤ –∏–∑ 6

**–£–ø–∞–≤—à–∏–µ —Ç–µ—Å—Ç—ã:**
- `should create user with email and password`
- `should NOT link telegram_id immediately`
- `should reject duplicate email`
- `should reject weak password`
- `should reject invalid email format`
- `should reject if telegram_id is already linked`

---

### 8. ‚ùå `server/routes/__tests__/link-telegram-miniapp.test.ts`
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–∏–≤—è–∑–∫–æ–π Telegram —á–µ—Ä–µ–∑ Mini App  
**–£–ø–∞–ª–æ:** 5 —Ç–µ—Å—Ç–æ–≤ –∏–∑ 5

**–£–ø–∞–≤—à–∏–µ —Ç–µ—Å—Ç—ã:**
- `should link telegram_id to authenticated user`
- `should reject if telegram_id is already linked to another user`
- `should reject invalid initData signature`
- `should reject old initData (replay attack prevention)`
- `should reject if user is not authenticated`

## –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

1. **React –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω –≤ —Ç–µ—Å—Ç–∞—Ö** (29 —Ç–µ—Å—Ç–æ–≤)
   - –ü—Ä–æ–±–ª–µ–º–∞ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ —Ç–µ—Å—Ç–æ–≤–æ–π —Å—Ä–µ–¥—ã –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∏–º–ø–æ—Ä—Ç–æ–≤
   - –ó–∞—Ç—Ä–∞–≥–∏–≤–∞–µ—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã Telegram

2. **–ü—Ä–æ–±–ª–µ–º—ã —Å Telegram Mini App** (15 —Ç–µ—Å—Ç–æ–≤)
   - –ü—Ä–æ–±–ª–µ–º—ã —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–µ–π –∏ –ø—Ä–∏–≤—è–∑–∫–æ–π —á–µ—Ä–µ–∑ Mini App
   - –í–æ–∑–º–æ–∂–Ω–æ, —Å–≤—è–∑–∞–Ω—ã —Å –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ –≤ –ª–æ–≥–∏–∫–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

3. **–ü—Ä–æ–±–ª–µ–º—ã —Å –º–æ–∫–∞–º–∏** (1 —Ñ–∞–π–ª)
   - `admin-audit-log.service.test.ts` –Ω–µ –º–æ–∂–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –º–æ–∫–∏

### –ù–µ–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

1. **I18n Provider** (2 —Ç–µ—Å—Ç–∞)
   - –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ `useTranslation` –≤–Ω–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞
   - –ù–µ –∫—Ä–∏—Ç–∏—á–Ω–æ, –Ω–æ —Å—Ç–æ–∏—Ç –∏—Å–ø—Ä–∞–≤–∏—Ç—å

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1 (–ö—Ä–∏—Ç–∏—á–Ω–æ)
1. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å –∏–º–ø–æ—Ä—Ç—ã React –≤ —Ç–µ—Å—Ç–∞—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ Telegram
2. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –º–æ–∫–æ–≤ –≤ `admin-audit-log.service.test.ts`
3. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏–∫—É Telegram Mini App –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2 (–í–∞–∂–Ω–æ)
1. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏ –ø—Ä–∏–≤—è–∑–∫–∏ —á–µ—Ä–µ–∑ Mini App
2. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å I18nProvider –≤ —Ç–µ—Å—Ç—ã, –≥–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `useTranslation`

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3 (–ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ)
1. ‚úÖ –£–ª—É—á—à–∏—Ç—å –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏ –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
2. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**–û–±—â–∏–π —Å—Ç–∞—Ç—É—Å:** üü° **–ß–∞—Å—Ç–∏—á–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç** (84% —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—Ö–æ–¥—è—Ç)

–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç–∞–µ—Ç (330 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—Ö–æ–¥—è—Ç), –Ω–æ –µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å:
- –¢–µ—Å—Ç–∞–º–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ Telegram (React –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω)
- Telegram Mini App –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π
- –ú–æ–∫–∞–º–∏ –≤ –æ–¥–Ω–æ–º –∏–∑ —Ç–µ—Å—Ç–æ–≤

**–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:**
1. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –∏–º–ø–æ—Ä—Ç—ã React –≤ —Ç–µ—Å—Ç–∞—Ö
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏–∫—É Telegram Mini App
3. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å –º–æ–∫–∞–º–∏
