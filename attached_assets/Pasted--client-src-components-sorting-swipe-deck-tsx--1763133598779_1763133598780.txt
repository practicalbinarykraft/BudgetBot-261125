üìÅ –ú–û–î–£–õ–¨–ù–ê–Ø –°–¢–†–£–ö–¢–£–†–ê
client/src/
  components/
    sorting/
      ‚îú‚îÄ swipe-deck.tsx                (180 —Å—Ç—Ä–æ–∫ - –≥–ª–∞–≤–Ω—ã–π)
      ‚îú‚îÄ ai-suggestion-box.tsx         (60 —Å—Ç—Ä–æ–∫ - AI –±–ª–æ–∫)
      ‚îú‚îÄ clickable-field-dropdown.tsx  (80 —Å—Ç—Ä–æ–∫ - dropdown)
      ‚îú‚îÄ training-header.tsx           (50 —Å—Ç—Ä–æ–∫ - –ø—Ä–æ–≥—Ä–µ—Å—Å AI)
      ‚îú‚îÄ completion-screen.tsx         (70 —Å—Ç—Ä–æ–∫ - —Ñ–∏–Ω–∏—à)
      ‚îî‚îÄ financial-insight-toast.tsx   (40 —Å—Ç—Ä–æ–∫ - –∏–Ω—Å–∞–π—Ç)

server/
  routes/
    ‚îî‚îÄ ai-prediction.routes.ts         (100 —Å—Ç—Ä–æ–∫ - API)
  
  services/
    ai/
      ‚îú‚îÄ prediction.service.ts         (150 —Å—Ç—Ä–æ–∫ - ML –¥–≤–∏–∂–æ–∫)
      ‚îú‚îÄ training.service.ts           (120 —Å—Ç—Ä–æ–∫ - –æ–±—É—á–µ–Ω–∏–µ)
      ‚îú‚îÄ similarity.service.ts         (80 —Å—Ç—Ä–æ–∫ - –ø–æ–∏—Å–∫ –ø–æ—Ö–æ–∂–∏—Ö)
      ‚îî‚îÄ confidence.service.ts         (60 —Å—Ç—Ä–æ–∫ - —Ä–∞—Å—á—ë—Ç —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏)

shared/
  ‚îî‚îÄ schema.ts                         (–¥–æ–±–∞–≤–∏—Ç—å 1 —Ç–∞–±–ª–∏—Ü—É)
–í–°–ï –§–ê–ô–õ–´ < 200 –°–¢–†–û–ö! ‚úÖ

–§–ê–ó–ê 1: BACKEND (2 —á–∞—Å–∞)
–ó–∞–¥–∞—á–∞ 1: –î–æ–±–∞–≤–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É ai_training_examples (10 –º–∏–Ω—É—Ç)
–§–∞–π–ª: shared/schema.ts
–î–æ–±–∞–≤–∏—Ç—å:
typescript/**
 * –ò—Å—Ç–æ—Ä–∏—è –æ–±—É—á–µ–Ω–∏—è AI
 * –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —á—Ç–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–ª AI –∏ —á—Ç–æ –≤—ã–±—Ä–∞–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
 */
export const aiTrainingExamples = pgTable("ai_training_examples", {
  id: serial("id").primaryKey(),
  
  userId: integer("user_id")
    .references(() => users.id, { onDelete: "cascade" })
    .notNull(),
  
  // Input (—á—Ç–æ –±—ã–ª–æ)
  transactionDescription: text("transaction_description").notNull(),
  transactionAmount: decimal("transaction_amount", { precision: 10, scale: 2 }),
  merchantName: text("merchant_name"),
  
  // AI Prediction (—á—Ç–æ AI –ø—Ä–µ–¥—Å–∫–∞–∑–∞–ª)
  aiSuggestedCategory: text("ai_suggested_category"),
  aiSuggestedTag: integer("ai_suggested_tag"),
  aiConfidence: decimal("ai_confidence", { precision: 3, scale: 2 }),
  
  // User Choice (—á—Ç–æ –≤—ã–±—Ä–∞–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)
  userChosenCategory: text("user_chosen_category"),
  userChosenTag: integer("user_chosen_tag"),
  userChosenType: text("user_chosen_type"),
  
  // Feedback
  aiWasCorrect: boolean("ai_was_correct").notNull(),
  // true –µ—Å–ª–∏ —é–∑–µ—Ä –ù–ï –º–µ–Ω—è–ª –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è AI
  
  createdAt: timestamp("created_at").defaultNow()
});
–†–∞–∑–º–µ—Ä: +20 —Å—Ç—Ä–æ–∫

–ó–∞–¥–∞—á–∞ 2: AI Prediction Service (150 —Å—Ç—Ä–æ–∫)
–°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª: server/services/ai/prediction.service.ts
typescriptimport { db } from '../../db';
import { 
  transactions, 
  aiTrainingExamples, 
  categories, 
  personalTags 
} from '@shared/schema';
import { findSimilarTransactions } from './similarity.service';
import { calculateConfidence } from './confidence.service';

/**
 * –ü—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç Category + Tag –¥–ª—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
 * –û—Å–Ω–æ–≤–∞–Ω–æ –Ω–∞ –ø—Ä–æ—à–ª—ã—Ö —Ä–µ—à–µ–Ω–∏—è—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
 */
export async function predictTransaction(
  transactionDescription: string,
  userId: number
) {
  // 1. –ù–∞–π—Ç–∏ –ø–æ—Ö–æ–∂–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏
  const similar = await findSimilarTransactions(
    transactionDescription,
    userId,
    limit: 10
  );
  
  if (similar.length === 0) {
    // –ù–µ—Ç –∏—Å—Ç–æ—Ä–∏–∏ - –≤–æ–∑–≤—Ä–∞—â–∞–µ–º null
    return {
      category: null,
      tag: null,
      confidence: 0,
      reasoning: 'No training data yet'
    };
  }
  
  // 2. –ü–æ–¥—Å—á–∏—Ç–∞—Ç—å —á–∞—Å—Ç–æ—Ç—É –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏/—Ç–µ–≥–∞
  const categoryCounts: Record<string, number> = {};
  const tagCounts: Record<number, number> = {};
  
  similar.forEach(tx => {
    if (tx.category) {
      categoryCounts[tx.category] = (categoryCounts[tx.category] || 0) + 1;
    }
    if (tx.personalTagId) {
      tagCounts[tx.personalTagId] = (tagCounts[tx.personalTagId] || 0) + 1;
    }
  });
  
  // 3. –ù–∞–π—Ç–∏ —Å–∞–º—ã–µ —á–∞—Å—Ç—ã–µ
  const mostFrequentCategory = Object.entries(categoryCounts)
    .sort(([, a], [, b]) => b - a)[0]?.[0];
  
  const mostFrequentTag = Object.entries(tagCounts)
    .sort(([, a], [, b]) => b - a)[0]?.[0];
  
  // 4. –†–∞—Å—Å—á–∏—Ç–∞—Ç—å confidence (0-1)
  const confidence = calculateConfidence(similar, {
    category: mostFrequentCategory,
    tag: parseInt(mostFrequentTag)
  });
  
  // 5. –í–µ—Ä–Ω—É—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ
  return {
    category: mostFrequentCategory || null,
    tag: mostFrequentTag ? parseInt(mostFrequentTag) : null,
    confidence: Math.round(confidence * 100), // 0-100%
    reasoning: `Based on ${similar.length} similar transactions`
  };
}

/**
 * –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏/—Ç–µ–≥–µ
 */
export async function enrichPrediction(prediction: any, userId: number) {
  if (!prediction.category && !prediction.tag) {
    return prediction;
  }
  
  // –ó–∞–≥—Ä—É–∑–∏—Ç—å category details
  let categoryDetails = null;
  if (prediction.category) {
    const [cat] = await db
      .select()
      .from(categories)
      .where(eq(categories.name, prediction.category))
      .limit(1);
    categoryDetails = cat;
  }
  
  // –ó–∞–≥—Ä—É–∑–∏—Ç—å tag details
  let tagDetails = null;
  if (prediction.tag) {
    const [tag] = await db
      .select()
      .from(personalTags)
      .where(eq(personalTags.id, prediction.tag))
      .limit(1);
    tagDetails = tag;
  }
  
  return {
    ...prediction,
    categoryDetails,
    tagDetails
  };
}
–†–∞–∑–º–µ—Ä: 150 —Å—Ç—Ä–æ–∫ ‚úÖ

–ó–∞–¥–∞—á–∞ 3: Similarity Service (80 —Å—Ç—Ä–æ–∫)
–°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª: server/services/ai/similarity.service.ts
typescriptimport { db } from '../../db';
import { aiTrainingExamples } from '@shared/schema';
import { eq, sql } from 'drizzle-orm';

/**
 * –ù–∞–π—Ç–∏ –ø–æ—Ö–æ–∂–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø–æ description
 * –ò—Å–ø–æ–ª—å–∑—É–µ—Ç PostgreSQL similarity (trigram)
 */
export async function findSimilarTransactions(
  description: string,
  userId: number,
  limit: number = 10
) {
  // –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å description (lowercase, —É–±—Ä–∞—Ç—å —Ü–∏—Ñ—Ä—ã)
  const normalized = normalizeDescription(description);
  
  // –ü–æ–∏—Å–∫ –ø–æ –ø–æ—Ö–æ–∂–µ—Å—Ç–∏ (PostgreSQL trigram)
  const results = await db
    .select()
    .from(aiTrainingExamples)
    .where(eq(aiTrainingExamples.userId, userId))
    .orderBy(
      sql`similarity(${aiTrainingExamples.transactionDescription}, ${normalized}) DESC`
    )
    .limit(limit);
  
  return results.map(r => ({
    category: r.userChosenCategory,
    personalTagId: r.userChosenTag,
    financialType: r.userChosenType,
    similarity: 0.8 // TODO: calculate real similarity
  }));
}

/**
 * –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è description –¥–ª—è –ø–æ–∏—Å–∫–∞
 */
function normalizeDescription(desc: string): string {
  return desc
    .toLowerCase()
    .replace(/\d+/g, '') // —É–±—Ä–∞—Ç—å —Ü–∏—Ñ—Ä—ã
    .replace(/[^\w\s]/g, '') // —É–±—Ä–∞—Ç—å —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª—ã
    .trim();
}

/**
 * –ò–∑–≤–ª–µ—á—å keywords –∏–∑ description
 */
export function extractKeywords(description: string): string[] {
  const normalized = normalizeDescription(description);
  
  // –†–∞–∑–±–∏—Ç—å –Ω–∞ —Å–ª–æ–≤–∞
  const words = normalized.split(/\s+/);
  
  // –£–±—Ä–∞—Ç—å —Å—Ç–æ–ø-—Å–ª–æ–≤–∞ (–≤, –Ω–∞, —Å, –¥–ª—è, etc)
  const stopWords = ['–≤', '–Ω–∞', '—Å', '–¥–ª—è', '–æ—Ç', '–¥–æ', '–ø–æ', '–∏–∑'];
  
  return words.filter(w => !stopWords.includes(w) && w.length > 2);
}
–†–∞–∑–º–µ—Ä: 80 —Å—Ç—Ä–æ–∫ ‚úÖ

–ó–∞–¥–∞—á–∞ 4: Confidence Service (60 —Å—Ç—Ä–æ–∫)
–°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª: server/services/ai/confidence.service.ts
typescript/**
 * –†–∞—Å—Å—á–∏—Ç–∞—Ç—å confidence score –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
 * –û—Å–Ω–æ–≤–∞–Ω–æ –Ω–∞:
 * - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ö–æ–∂–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
 * - –ß–∞—Å—Ç–æ—Ç–∞ –≤—Å—Ç—Ä–µ—á–∞–µ–º–æ—Å—Ç–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è
 * - Similarity score
 */
export function calculateConfidence(
  similarTransactions: any[],
  prediction: { category: string | null; tag: number | null }
): number {
  if (similarTransactions.length === 0) {
    return 0;
  }
  
  // 1. –ë–∞–∑–æ–≤—ã–π score –æ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø—Ä–∏–º–µ—Ä–æ–≤
  const countScore = Math.min(similarTransactions.length / 10, 1);
  
  // 2. Frequency score (–∫–∞–∫ —á–∞—Å—Ç–æ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ)
  const categoryMatches = similarTransactions.filter(
    tx => tx.category === prediction.category
  ).length;
  
  const tagMatches = similarTransactions.filter(
    tx => tx.personalTagId === prediction.tag
  ).length;
  
  const frequencyScore = 
    (categoryMatches + tagMatches) / (similarTransactions.length * 2);
  
  // 3. Average similarity score
  const avgSimilarity = 
    similarTransactions.reduce((sum, tx) => sum + (tx.similarity || 0), 0) 
    / similarTransactions.length;
  
  // 4. –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π score (weighted average)
  const finalScore = 
    countScore * 0.3 + 
    frequencyScore * 0.4 + 
    avgSimilarity * 0.3;
  
  return Math.min(finalScore, 0.99); // Max 99%
}
–†–∞–∑–º–µ—Ä: 60 —Å—Ç—Ä–æ–∫ ‚úÖ

–ó–∞–¥–∞—á–∞ 5: Training Service (120 —Å—Ç—Ä–æ–∫)
–°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª: server/services/ai/training.service.ts
typescriptimport { db } from '../../db';
import { aiTrainingExamples } from '@shared/schema';

/**
 * –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–∏–º–µ—Ä –¥–ª—è –æ–±—É—á–µ–Ω–∏—è AI
 * –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —Å–≤–∞–π–ø–∞
 */
export async function saveTrainingExample(data: {
  userId: number;
  transactionDescription: string;
  transactionAmount: number;
  merchantName?: string;
  
  // AI prediction
  aiSuggestedCategory?: string;
  aiSuggestedTag?: number;
  aiConfidence?: number;
  
  // User choice
  userChosenCategory?: string;
  userChosenTag?: number;
  userChosenType: string; // from swipe direction
}) {
  // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å AI
  const aiWasCorrect = 
    data.aiSuggestedCategory === data.userChosenCategory &&
    data.aiSuggestedTag === data.userChosenTag;
  
  // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
  await db.insert(aiTrainingExamples).values({
    userId: data.userId,
    transactionDescription: data.transactionDescription,
    transactionAmount: data.transactionAmount.toString(),
    merchantName: data.merchantName,
    
    aiSuggestedCategory: data.aiSuggestedCategory,
    aiSuggestedTag: data.aiSuggestedTag,
    aiConfidence: data.aiConfidence?.toString(),
    
    userChosenCategory: data.userChosenCategory,
    userChosenTag: data.userChosenTag,
    userChosenType: data.userChosenType,
    
    aiWasCorrect
  });
}

/**
 * –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –æ–±—É—á–µ–Ω–∏—è AI –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
 */
export async function getTrainingStats(userId: number) {
  const examples = await db
    .select()
    .from(aiTrainingExamples)
    .where(eq(aiTrainingExamples.userId, userId));
  
  const totalExamples = examples.length;
  const correctPredictions = examples.filter(e => e.aiWasCorrect).length;
  const accuracy = totalExamples > 0 
    ? Math.round((correctPredictions / totalExamples) * 100) 
    : 0;
  
  // –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å AI
  let level: string;
  if (totalExamples < 10) level = 'ü•â Beginner';
  else if (totalExamples < 50) level = 'ü•à Intermediate';
  else if (totalExamples < 100) level = 'ü•á Advanced';
  else level = 'üíé Master';
  
  return {
    totalExamples,
    correctPredictions,
    accuracy,
    level,
    canEnableAutoMode: accuracy >= 80 && totalExamples >= 50
  };
}
–†–∞–∑–º–µ—Ä: 120 —Å—Ç—Ä–æ–∫ ‚úÖ

–ó–∞–¥–∞—á–∞ 6: API Routes (100 —Å—Ç—Ä–æ–∫)
–°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª: server/routes/ai-prediction.routes.ts
typescriptimport { Router } from 'express';
import { requireAuth } from '../middleware/auth';
import { predictTransaction, enrichPrediction } from '../services/ai/prediction.service';
import { getTrainingStats, saveTrainingExample } from '../services/ai/training.service';

const router = Router();

/**
 * GET /api/ai/predict/:transactionId
 * –ü—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å category + tag –¥–ª—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
 */
router.get('/predict/:transactionId', requireAuth, async (req, res) => {
  const userId = req.user!.id;
  const { transactionId } = req.params;
  
  try {
    // –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
    const transaction = await db
      .select()
      .from(transactions)
      .where(eq(transactions.id, parseInt(transactionId)))
      .limit(1);
    
    if (!transaction[0]) {
      return res.status(404).json({ error: 'Transaction not found' });
    }
    
    // –ü—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å
    const prediction = await predictTransaction(
      transaction[0].description,
      userId
    );
    
    // –î–æ–±–∞–≤–∏—Ç—å –¥–µ—Ç–∞–ª–∏ (name, icon)
    const enriched = await enrichPrediction(prediction, userId);
    
    res.json(enriched);
  } catch (error) {
    res.status(500).json({ error: 'Prediction failed' });
  }
});

/**
 * POST /api/ai/train
 * –°–æ—Ö—Ä–∞–Ω–∏—Ç—å training example –ø–æ—Å–ª–µ —Å–≤–∞–π–ø–∞
 */
router.post('/train', requireAuth, async (req, res) => {
  const userId = req.user!.id;
  const { transactionId, userChoice, aiPrediction } = req.body;
  
  try {
    // –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
    const [tx] = await db
      .select()
      .from(transactions)
      .where(eq(transactions.id, transactionId))
      .limit(1);
    
    // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å training example
    await saveTrainingExample({
      userId,
      transactionDescription: tx.description,
      transactionAmount: parseFloat(tx.amountUsd),
      
      aiSuggestedCategory: aiPrediction?.category,
      aiSuggestedTag: aiPrediction?.tag,
      aiConfidence: aiPrediction?.confidence,
      
      userChosenCategory: userChoice.category,
      userChosenTag: userChoice.tag,
      userChosenType: userChoice.financialType
    });
    
    res.json({ success: true });
  } catch (error) {
    res.status(500).json({ error: 'Training save failed' });
  }
});

/**
 * GET /api/ai/stats
 * –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –æ–±—É—á–µ–Ω–∏—è AI
 */
router.get('/stats', requireAuth, async (req, res) => {
  const userId = req.user!.id;
  
  try {
    const stats = await getTrainingStats(userId);
    res.json(stats);
  } catch (error) {
    res.status(500).json({ error: 'Failed to load stats' });
  }
});

export default router;
–†–∞–∑–º–µ—Ä: 100 —Å—Ç—Ä–æ–∫ ‚úÖ
–ü–æ–¥–∫–ª—é—á–∏—Ç—å –≤ server/index.ts:
typescriptimport aiPredictionRoutes from './routes/ai-prediction.routes';
app.use('/api/ai', aiPredictionRoutes);

–§–ê–ó–ê 2: FRONTEND (2.5 —á–∞—Å–∞)
–ó–∞–¥–∞—á–∞ 7: Clickable Field Dropdown (80 —Å—Ç—Ä–æ–∫)
–°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª: client/src/components/sorting/clickable-field-dropdown.tsx
typescriptimport { useState } from 'react';
import { Popover, PopoverTrigger, PopoverContent } from '@/components/ui/popover';
import { useQuery } from '@tanstack/react-query';

/**
 * –ö–ª–∏–∫–∞–±–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ —Å dropdown
 * –ü—Ä–∏ –∫–ª–∏–∫–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –¥–ª—è –≤—ã–±–æ—Ä–∞
 */
interface ClickableFieldDropdownProps {
  type: 'category' | 'tag';
  value: { name: string; icon?: string } | null;
  onChange: (value: any) => void;
}

export function ClickableFieldDropdown({ 
  type, 
  value, 
  onChange 
}: ClickableFieldDropdownProps) {
  const [open, setOpen] = useState(false);
  
  // –ó–∞–≥—Ä—É–∑–∏—Ç—å –æ–ø—Ü–∏–∏
  const { data: options = [] } = useQuery({
    queryKey: type === 'category' 
      ? ['/api/categories'] 
      : ['/api/tags'],
  });
  
  return (
    <Popover open={open} onOpenChange={setOpen}>
      <PopoverTrigger asChild>
        <button 
          className="flex items-center gap-2 px-3 py-2 rounded-lg 
                     border-2 border-dashed border-gray-300 
                     hover:border-blue-500 hover:bg-blue-50
                     transition-all cursor-pointer"
        >
          {value ? (
            <>
              <span>{value.icon}</span>
              <span>{value.name}</span>
            </>
          ) : (
            <span className="text-gray-400">
              {type === 'category' ? 'Select category...' : 'Select tag...'}
            </span>
          )}
          <span className="ml-auto text-gray-400">‚ñº</span>
        </button>
      </PopoverTrigger>
      
      <PopoverContent className="w-64 max-h-64 overflow-auto">
        <div className="space-y-1">
          {options.map(option => (
            <button
              key={option.id}
              onClick={() => {
                onChange(option);
                setOpen(false);
              }}
              className="w-full flex items-center gap-2 px-3 py-2 
                         rounded hover:bg-gray-100 text-left"
            >
              {option.icon && <span>{option.icon}</span>}
              <span>{option.name}</span>
            </button>
          ))}
        </div>
      </PopoverContent>
    </Popover>
  );
}
–†–∞–∑–º–µ—Ä: 80 —Å—Ç—Ä–æ–∫ ‚úÖ

–ó–∞–¥–∞—á–∞ 8: AI Suggestion Box (60 —Å—Ç—Ä–æ–∫)
–°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª: client/src/components/sorting/ai-suggestion-box.tsx
typescriptimport { ClickableFieldDropdown } from './clickable-field-dropdown';

/**
 * –ë–ª–æ–∫ —Å AI –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è–º–∏
 * –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç Category + Tag —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –∏–∑–º–µ–Ω–∏—Ç—å
 */
interface AISuggestionBoxProps {
  prediction: {
    category: { name: string; icon: string } | null;
    tag: { name: string; icon: string } | null;
    confidence: number;
  } | null;
  onCategoryChange: (category: any) => void;
  onTagChange: (tag: any) => void;
}

export function AISuggestionBox({
  prediction,
  onCategoryChange,
  onTagChange
}: AISuggestionBoxProps) {
  if (!prediction) {
    return (
      <div className="p-4 bg-gray-50 rounded-lg">
        <p className="text-sm text-gray-500">
          ü§ñ AI is learning... No suggestions yet.
        </p>
      </div>
    );
  }
  
  return (
    <div className="p-4 bg-blue-50 rounded-lg space-y-3">
      <div className="flex items-center justify-between">
        <span className="text-sm font-medium text-blue-900">
          ü§ñ AI suggests:
        </span>
        <span className="text-xs text-blue-600">
          {prediction.confidence}% confident
        </span>
      </div>
      
      {/* Category field (clickable) */}
      <ClickableFieldDropdown
        type="category"
        value={prediction.category}
        onChange={onCategoryChange}
      />
      
      {/* Tag field (clickable) */}
      <ClickableFieldDropdown
        type="tag"
        value={prediction.tag}
        onChange={onTagChange}
      />
      
      <p className="text-xs text-blue-600">
        üí° Click fields above to change if AI is wrong
      </p>
    </div>
  );
}
–†–∞–∑–º–µ—Ä: 60 —Å—Ç—Ä–æ–∫ ‚úÖ

–ó–∞–¥–∞—á–∞ 9: Training Header (50 —Å—Ç—Ä–æ–∫)
–°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª: client/src/components/sorting/training-header.tsx
typescriptimport { useQuery } from '@tanstack/react-query';

/**
 * Header —Å –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º –æ–±—É—á–µ–Ω–∏—è AI
 */
export function TrainingHeader() {
  const { data: stats } = useQuery({
    queryKey: ['/api/ai/stats'],
  });
  
  if (!stats) return null;
  
  return (
    <div className="mb-6 p-4 bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg">
      <h2 className="text-lg font-bold mb-2">
        ü§ñ Train Your Personal AI Assistant
      </h2>
      
      <p className="text-sm text-gray-600 mb-3">
        Each swipe teaches AI to recognize your spending patterns!
      </p>
      
      <div className="flex items-center gap-4 text-sm">
        <div>
          <span className="font-medium">Level:</span> {stats.level}
        </div>
        <div>
          <span className="font-medium">Sessions:</span> {stats.totalExamples}
        </div>
        <div>
          <span className="font-medium">Accuracy:</span> {stats.accuracy}%
        </div>
      </div>
      
      {/* Progress bar */}
      <div className="mt-3 h-2 bg-gray-200 rounded-full overflow-hidden">
        <div 
          className="h-full bg-blue-500 transition-all"
          style={{ width: `${stats.accuracy}%` }}
        />
      </div>
    </div>
  );
}
–†–∞–∑–º–µ—Ä: 50 —Å—Ç—Ä–æ–∫ ‚úÖ

–ó–∞–¥–∞—á–∞ 10: –û–±–Ω–æ–≤–∏—Ç—å Swipe Deck (180 —Å—Ç—Ä–æ–∫)
–§–∞–π–ª: client/src/components/sorting/swipe-deck.tsx
–ß—Ç–æ –∏–∑–º–µ–Ω–∏—Ç—å:
typescriptimport { TrainingHeader } from './training-header';
import { AISuggestionBox } from './ai-suggestion-box';
import { useQuery, useMutation } from '@tanstack/react-query';

export function SwipeDeck() {
  // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ ...
  
  // ‚úÖ –î–û–ë–ê–í–ò–¢–¨: –ó–∞–≥—Ä—É–∑–∫–∞ AI prediction
  const { data: prediction } = useQuery({
    queryKey: ['/api/ai/predict', currentCard?.id],
    enabled: !!currentCard,
  });
  
  // ‚úÖ –î–û–ë–ê–í–ò–¢–¨: State –¥–ª—è user overrides
  const [userCategory, setUserCategory] = useState(null);
  const [userTag, setUserTag] = useState(null);
  
  // ‚úÖ –î–û–ë–ê–í–ò–¢–¨: Mutation –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è training example
  const trainMutation = useMutation({
    mutationFn: async (data: any) => {
      await fetch('/api/ai/train', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
      });
    }
  });
  
  // ‚úÖ –ò–ó–ú–ï–ù–ò–¢–¨: handleSwipe
  const handleSwipe = async (direction: Direction) => {
    const financialType = directionToType(direction);
    
    // Final values (AI or user override)
    const finalCategory = userCategory || prediction?.category?.name;
    const finalTag = userTag || prediction?.tag?.id;
    
    // 1. Update transaction
    await updateTransaction(currentCard.id, {
      financialType,
      category: finalCategory,
      personalTagId: finalTag
    });
    
    // 2. Save training example (–æ–±—É—á–∏—Ç—å AI)
    await trainMutation.mutateAsync({
      transactionId: currentCard.id,
      aiPrediction: prediction,
      userChoice: {
        financialType,
        category: finalCategory,
        tag: finalTag
      }
    });
    
    // 3. Next card
    setCurrentIndex(prev => prev + 1);
    setUserCategory(null);
    setUserTag(null);
  };
  
  return (
    <div>
      {/* ‚úÖ –î–û–ë–ê–í–ò–¢–¨: Training Header */}
      <TrainingHeader />
      
      {/* Existing progress */}
      <Progress ... />
      
      {/* Card */}
      <Card>
        {/* Transaction details */}
        <TransactionDetails {...currentCard} />
        
        {/* ‚úÖ –î–û–ë–ê–í–ò–¢–¨: AI Suggestions */}
        <AISuggestionBox
          prediction={prediction}
          onCategoryChange={setUserCategory}
          onTagChange={setUserTag}
        />
        
        {/* Swipe directions */}
        <SwipeDirections />
      </Card>
    </div>
  );
}
–†–∞–∑–º–µ—Ä –∏—Ç–æ–≥–æ–≤—ã–π: ~180 —Å—Ç—Ä–æ–∫ ‚úÖ

–ó–∞–¥–∞—á–∞ 11: Financial Insight Toast (40 —Å—Ç—Ä–æ–∫)
–°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª: client/src/components/sorting/financial-insight-toast.tsx
typescriptimport { useToast } from '@/hooks/use-toast';

/**
 * –ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Å–∞–π—Ç –ø–æ—Å–ª–µ —Å–≤–∞–π–ø–∞
 * "üí° You're spending 60% on Discretionary!"
 */
export function useFinancialInsightToast() {
  const { toast } = useToast();
  
  const showInsight = (stats: {
    discretionaryPercent: number;
    essentialPercent: number;
    assetPercent: number;
  }) => {
    let message = '';
    let variant: 'default' | 'destructive' = 'default';
    
    if (stats.discretionaryPercent > 50) {
      message = `‚ö†Ô∏è You're spending ${stats.discretionaryPercent}% on wants! Consider reducing.`;
      variant = 'destructive';
    } else if (stats.assetPercent < 10) {
      message = `üéØ Only ${stats.assetPercent}% goes to investments. Try to increase!`;
    } else {
      message = `‚úÖ Good balance! ${stats.essentialPercent}% essential, ${stats.assetPercent}% assets.`;
    }
    
    toast({
      title: 'üí° Financial Insight',
      description: message,
      variant
    });
  };
  
  return { showInsight };
}
–†–∞–∑–º–µ—Ä: 40 —Å—Ç—Ä–æ–∫ ‚úÖ

–§–ê–ó–ê 3: –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø (30 –º–∏–Ω—É—Ç)
–ó–∞–¥–∞—á–∞ 12: –ü–æ–∫–∞–∑–∞—Ç—å insights –ø–æ—Å–ª–µ —Å–≤–∞–π–ø–∞
–í swipe-deck.tsx:
typescriptimport { useFinancialInsightToast } from './financial-insight-toast';

// –í –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ:
const { showInsight } = useFinancialInsightToast();

// –ü–æ—Å–ª–µ handleSwipe:
const handleSwipe = async (direction) => {
  // ... save transaction ...
  
  // ‚úÖ –î–û–ë–ê–í–ò–¢–¨: Show insight –∫–∞–∂–¥—ã–µ 5 —Å–≤–∞–π–ø–æ–≤
  if ((currentIndex + 1) % 5 === 0) {
    const stats = await fetchMonthlyStats();
    showInsight(stats);
  }
  
  // Next card
  setCurrentIndex(prev => prev + 1);
};
```

---

## ‚úÖ –ö–†–ò–¢–ï–†–ò–ò –£–°–ü–ï–•–ê

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:
```
1. –û—Ç–∫—Ä—ã—Ç—å /sorting
2. –í–∏–¥–µ—Ç—å Training Header —Å –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º AI
3. –í–∏–¥–µ—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
4. –í–∏–¥–µ—Ç—å AI Suggestion Box:
   - Category (clickable)
   - Tag (clickable)
   - Confidence %
5. –ö–ª–∏–∫ –Ω–∞ Category ‚Üí dropdown ‚Üí –≤—ã–±—Ä–∞—Ç—å –¥—Ä—É–≥—É—é
6. –°–≤–∞–π–ø–Ω—É—Ç—å –≤–ø—Ä–∞–≤–æ (Discretionary)
7. –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ —Å:
   - financialType: discretionary
   - category: –≤—ã–±—Ä–∞–Ω–Ω–∞—è (–∏–ª–∏ AI)
   - tag: –≤—ã–±—Ä–∞–Ω–Ω—ã–π (–∏–ª–∏ AI)
8. Training example —Å–æ—Ö—Ä–∞–Ω—ë–Ω –≤ –ë–î
9. –°–ª–µ–¥—É—é—â–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É–ª—É—á—à–µ–Ω–Ω–æ–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ
```

---

## üí° –ü–û–ß–ï–ú–£ –≠–¢–û –•–û–†–û–®–û –î–õ–Ø –î–ñ–£–ù–ê
```
‚úÖ 11 —Ñ–∞–π–ª–æ–≤, –≤—Å–µ < 200 —Å—Ç—Ä–æ–∫
‚úÖ –ö–∞–∂–¥—ã–π —Ñ–∞–π–ª = –æ–¥–Ω–∞ –∑–∞–¥–∞—á–∞:
   - prediction.service.ts = ML –¥–≤–∏–∂–æ–∫
   - similarity.service.ts = –ø–æ–∏—Å–∫ –ø–æ—Ö–æ–∂–∏—Ö
   - confidence.service.ts = —Ä–∞—Å—á—ë—Ç —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏
   - training.service.ts = —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–∏–º–µ—Ä–æ–≤
   - clickable-field-dropdown.tsx = dropdown –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
   - ai-suggestion-box.tsx = –±–ª–æ–∫ —Å AI
   - training-header.tsx = –ø—Ä–æ–≥—Ä–µ—Å—Å –±–∞—Ä

‚úÖ –ü–æ–Ω—è—Ç–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è
‚úÖ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≥–¥–µ –Ω—É–∂–Ω–æ
‚úÖ –õ–µ–≥–∫–æ –Ω–∞–π—Ç–∏ —á—Ç–æ –ø—Ä–∞–≤–∏—Ç—å
```

---

## üöÄ –†–ê–ó–ú–ï–† –ò–ó–ú–ï–ù–ï–ù–ò–ô
```
Backend:
- –ù–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤: 5
- –ù–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞: 1
- –°—Ç—Ä–æ–∫: ~500

Frontend:
- –ù–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤: 5
- –ò–∑–º–µ–Ω—ë–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤: 1
- –°—Ç—Ä–æ–∫: ~300

–ò–¢–û–ì–û: ~800 —Å—Ç—Ä–æ–∫, 4.5 —á–∞—Å–∞