Ğ¨ĞĞ“ 11: Ğ¡ĞĞ—Ğ”ĞĞ¢Ğ¬ Ğ¡Ğ¢Ğ ĞĞĞ˜Ğ¦Ğ£ ASSETS
typescriptâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Ğ—ĞĞ”ĞĞ§Ğ: Ğ“Ğ»Ğ°Ğ²Ğ½Ğ°Ñ ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ğ° Ğ°ĞºÑ‚Ğ¸Ğ²Ğ¾Ğ² Ñ Ñ‚Ğ°Ğ±Ğ°Ğ¼Ğ¸
Ğ¤ĞĞ™Ğ›: client/src/pages/assets.tsx
Ğ¡Ğ¢Ğ ĞĞš: ~180
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Ğ¡ĞĞ—Ğ”ĞĞ™ Ğ¤ĞĞ™Ğ›: client/src/pages/assets.tsx

Ğ¡ĞĞ”Ğ•Ğ Ğ–Ğ˜ĞœĞĞ•:

import { useState } from 'react';
import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';
import { Plus, TrendingUp, TrendingDown } from 'lucide-react';
import { AssetList } from '@/components/assets/asset-list';
import { AssetForm } from '@/components/assets/asset-form';
import type { Asset, NetWorthSummary } from '@/lib/types/assets';

export default function AssetsPage() {
  const [activeTab, setActiveTab] = useState<'asset' | 'liability'>('asset');
  const [showForm, setShowForm] = useState(false);
  const queryClient = useQueryClient();
  
  // ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ²ÑĞµ Ğ°ĞºÑ‚Ğ¸Ğ²Ñ‹
  const { data: assetsData, isLoading } = useQuery({
    queryKey: ['/api/assets'],
    queryFn: async () => {
      const res = await fetch('/api/assets');
      if (!res.ok) throw new Error('Failed to fetch assets');
      const json = await res.json();
      return json.data;
    }
  });
  
  // ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ ÑĞ²Ğ¾Ğ´ĞºÑƒ
  const { data: summary } = useQuery<NetWorthSummary>({
    queryKey: ['/api/assets/summary'],
    queryFn: async () => {
      const res = await fetch('/api/assets/summary');
      if (!res.ok) throw new Error('Failed to fetch summary');
      const json = await res.json();
      return json.data;
    }
  });
  
  // ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸ Ğ´Ğ»Ñ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ¾Ğ²
  const { data: categories } = useQuery({
    queryKey: ['/api/categories'],
    queryFn: async () => {
      const res = await fetch('/api/categories');
      if (!res.ok) throw new Error('Failed to fetch categories');
      const json = await res.json();
      return json.data.filter((c: any) => 
        c.applicableTo === 'asset' || c.applicableTo === 'both'
      );
    }
  });
  
  // Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ°ĞºÑ‚Ğ¸Ğ²
  const createMutation = useMutation({
    mutationFn: async (data: any) => {
      const res = await fetch('/api/assets', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
      });
      if (!res.ok) throw new Error('Failed to create asset');
      return res.json();
    },
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: ['/api/assets'] });
      queryClient.invalidateQueries({ queryKey: ['/api/assets/summary'] });
    }
  });
  
  // Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¿Ğ¾ Ñ‚Ğ°Ğ±Ñƒ
  const filteredGrouped = assetsData?.grouped 
    ? Object.fromEntries(
        Object.entries(assetsData.grouped).map(([category, assets]: [string, any]) => [
          category,
          (assets as Asset[]).filter(a => a.type === activeTab)
        ]).filter(([_, assets]) => (assets as Asset[]).length > 0)
      )
    : {};
  
  const isPositive = (summary?.changePercent || 0) >= 0;
  
  return (
    <div className="max-w-7xl mx-auto px-4 py-8">
      {/* Ğ—Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²Ğ¾Ğº Ñ ÑĞ²Ğ¾Ğ´ĞºĞ¾Ğ¹ */}
      <div className="mb-8">
        <h1 className="text-3xl font-bold mb-2">ĞĞºÑ‚Ğ¸Ğ²Ñ‹ Ğ¸ Ğ¿Ğ°ÑÑĞ¸Ğ²Ñ‹</h1>
        <p className="text-gray-600 mb-4">
          Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞ¹Ñ‚Ğµ ÑĞ²Ğ¾Ğ¸Ğ¼Ğ¸ Ğ²ĞµÑ‰Ğ°Ğ¼Ğ¸ Ğ¸ Ğ¾Ñ‚ÑĞ»ĞµĞ¶Ğ¸Ğ²Ğ°Ğ¹Ñ‚Ğµ Ğ¸Ñ… ÑÑ‚Ğ¾Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ
        </p>
        
        {/* Ğ¡Ğ²Ğ¾Ğ´ĞºĞ° */}
        {summary && (
          <div className="bg-gradient-to-br from-purple-500 to-indigo-600 text-white rounded-lg p-6">
            <div className="flex items-center justify-between mb-4">
              <div>
                <p className="text-sm opacity-80">Ğ§Ğ¸ÑÑ‚Ñ‹Ğ¹ ĞºĞ°Ğ¿Ğ¸Ñ‚Ğ°Ğ» (Net Worth)</p>
                <p className="text-4xl font-bold">
                  ${summary.netWorth.toLocaleString('en-US', { maximumFractionDigits: 0 })}
                </p>
              </div>
              
              <div className={`flex items-center gap-2 text-lg ${
                isPositive ? 'text-green-200' : 'text-red-200'
              }`}>
                {isPositive ? <TrendingUp size={24} /> : <TrendingDown size={24} />}
                <span>{isPositive ? '+' : ''}{summary.changePercent.toFixed(1)}%</span>
              </div>
            </div>
            
            <div className="grid grid-cols-3 gap-3">
              <div className="bg-white/10 p-3 rounded">
                <p className="text-xs opacity-80">ĞĞºÑ‚Ğ¸Ğ²Ñ‹</p>
                <p className="text-lg font-semibold">
                  ${(summary.totalAssets / 1000).toFixed(0)}K
                </p>
              </div>
              
              <div className="bg-white/10 p-3 rounded">
                <p className="text-xs opacity-80">ĞŸĞ°ÑÑĞ¸Ğ²Ñ‹</p>
                <p className="text-lg font-semibold">
                  ${(summary.totalLiabilities / 1000).toFixed(0)}K
                </p>
              </div>
              
              <div className="bg-white/10 p-3 rounded">
                <p className="text-xs opacity-80">Cashflow</p>
                <p className={`text-lg font-semibold ${
                  summary.monthlyCashflow >= 0 ? 'text-green-200' : 'text-red-200'
                }`}>
                  {summary.monthlyCashflow >= 0 ? '+' : ''}${summary.monthlyCashflow.toFixed(0)}/Ğ¼ĞµÑ
                </p>
              </div>
            </div>
          </div>
        )}
      </div>
      
      {/* Ğ¢Ğ°Ğ±Ñ‹ Ğ¸ ĞºĞ½Ğ¾Ğ¿ĞºĞ¸ */}
      <div className="flex items-center justify-between mb-6">
        <div className="flex gap-2">
          <button
            onClick={() => setActiveTab('asset')}
            className={`px-6 py-2 rounded-lg font-medium transition ${
              activeTab === 'asset'
                ? 'bg-green-100 text-green-700'
                : 'bg-gray-100 text-gray-600 hover:bg-gray-200'
            }`}
          >
            ğŸ“ˆ ĞĞºÑ‚Ğ¸Ğ²Ñ‹
          </button>
          <button
            onClick={() => setActiveTab('liability')}
            className={`px-6 py-2 rounded-lg font-medium transition ${
              activeTab === 'liability'
                ? 'bg-red-100 text-red-700'
                : 'bg-gray-100 text-gray-600 hover:bg-gray-200'
            }`}
          >
            ğŸ“‰ ĞŸĞ°ÑÑĞ¸Ğ²Ñ‹
          </button>
        </div>
        
        <button
          onClick={() => setShowForm(true)}
          className="flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"
        >
          <Plus size={20} />
          Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ {activeTab === 'asset' ? 'Ğ°ĞºÑ‚Ğ¸Ğ²' : 'Ğ¿Ğ°ÑÑĞ¸Ğ²'}
        </button>
      </div>
      
      {/* Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº */}
      {isLoading ? (
        <div className="text-center py-12">
          <p className="text-gray-500">Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ°...</p>
        </div>
      ) : (
        <AssetList 
          groupedAssets={filteredGrouped}
          emptyMessage={
            activeTab === 'asset' 
              ? 'ĞĞºÑ‚Ğ¸Ğ²Ğ¾Ğ² Ğ¿Ğ¾ĞºĞ° Ğ½ĞµÑ‚. Ğ”Ğ¾Ğ±Ğ°Ğ²ÑŒÑ‚Ğµ Ğ¿ĞµÑ€Ğ²Ñ‹Ğ¹ Ğ°ĞºÑ‚Ğ¸Ğ²!' 
              : 'ĞŸĞ°ÑÑĞ¸Ğ²Ğ¾Ğ² Ğ¿Ğ¾ĞºĞ° Ğ½ĞµÑ‚.'
          }
        />
      )}
      
      {/* Ğ¤Ğ¾Ñ€Ğ¼Ğ° */}
      {showForm && (
        <AssetForm
          type={activeTab}
          categories={categories || []}
          onSubmit={(data) => createMutation.mutateAsync(data)}
          onClose={() => setShowForm(false)}
        />
      )}
    </div>
  );
}

ĞŸĞ ĞĞ’Ğ•Ğ ĞšĞ:
âœ… Ğ¤Ğ°Ğ¹Ğ» ÑĞ¾Ğ·Ğ´Ğ°Ğ½
âœ… Ğ¢Ğ°Ğ±Ñ‹ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ÑÑ‚
âœ… Ğ¡Ğ²Ğ¾Ğ´ĞºĞ° Ğ¾Ñ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶Ğ°ĞµÑ‚ÑÑ
âœ… Ğ¤Ğ¾Ñ€Ğ¼Ğ° Ğ¾Ñ‚ĞºÑ€Ñ‹Ğ²Ğ°ĞµÑ‚ÑÑ