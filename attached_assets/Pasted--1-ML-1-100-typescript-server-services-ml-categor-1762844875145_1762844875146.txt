üèóÔ∏è –ü–†–ê–í–ò–õ–¨–ù–ê–Ø –ê–†–•–ò–¢–ï–ö–¢–£–†–ê
1. –°–µ—Ä–≤–∏—Å ML (1 —Ñ–∞–π–ª, ~100 —Å—Ç—Ä–æ–∫)
typescript// server/services/ml-categories.ts

import { db } from '../db/client';
import { merchantCategories } from '@shared/schema';
import { eq, and } from 'drizzle-orm';

/**
 * –û—á–∏—Å—Ç–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ –¥–ª—è –ø–æ–∏—Å–∫–∞
 * "STARBUCKS  Coffee" ‚Üí "starbucks coffee"
 */
function normalize(text: string): string {
  return text
    .toLowerCase()
    .trim()
    .replace(/\s+/g, ' '); // –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–µ–ª—ã ‚Üí –æ–¥–∏–Ω
}

/**
 * –ü–æ–ª—É—á–∏—Ç—å –≤—ã—É—á–µ–Ω–Ω—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é
 * @returns { category: string, confidence: number } –∏–ª–∏ null
 */
export async function getSuggestedCategory(
  userId: number,
  description: string
): Promise<{ category: string; confidence: number } | null> {
  const normalized = normalize(description);
  
  const [result] = await db
    .select()
    .from(merchantCategories)
    .where(
      and(
        eq(merchantCategories.userId, userId),
        eq(merchantCategories.merchantName, normalized)
      )
    )
    .limit(1);
  
  if (!result) return null;
  
  // Confidence –∑–∞–≤–∏—Å–∏—Ç –æ—Ç usageCount:
  // 1 —Ä–∞–∑ = 60%, 2-4 —Ä–∞–∑–∞ = 80%, 5+ = 95%
  const confidence = result.usageCount === 1 
    ? 0.6 
    : result.usageCount < 5 
    ? 0.8 
    : 0.95;
  
  return {
    category: result.categoryName,
    confidence
  };
}

/**
 * –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–≤—è–∑–∫—É description ‚Üí category
 * –£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Å—á—ë—Ç—á–∏–∫ –µ—Å–ª–∏ —É–∂–µ –µ—Å—Ç—å
 */
export async function learnCategory(
  userId: number,
  description: string,
  category: string
): Promise<void> {
  const normalized = normalize(description);
  
  // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Å–≤—è–∑–∫—É
  const existing = await db
    .select()
    .from(merchantCategories)
    .where(
      and(
        eq(merchantCategories.userId, userId),
        eq(merchantCategories.merchantName, normalized)
      )
    )
    .limit(1);
  
  if (existing.length > 0) {
    // –û–±–Ω–æ–≤–∏—Ç—å: +1 –∫ —Å—á—ë—Ç—á–∏–∫—É, –æ–±–Ω–æ–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é
    await db
      .update(merchantCategories)
      .set({
        categoryName: category,
        usageCount: existing[0].usageCount + 1,
        lastUsedAt: new Date()
      })
      .where(eq(merchantCategories.id, existing[0].id));
  } else {
    // –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é
    await db
      .insert(merchantCategories)
      .values({
        userId,
        merchantName: normalized,
        categoryName: category,
        usageCount: 1
      });
  }
}
–†–∞–∑–º–µ—Ä: ~100 —Å—Ç—Ä–æ–∫ ‚úÖ
–§—É–Ω–∫—Ü–∏–∏: 3 —à—Ç—É–∫–∏, –∫–∞–∂–¥–∞—è <40 —Å—Ç—Ä–æ–∫ ‚úÖ
–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: –¢–æ–ª—å–∫–æ DB ‚úÖ

2. Middleware –¥–ª—è –∞–≤—Ç–æ–æ–±—É—á–µ–Ω–∏—è (–ö–õ–Æ–ß–ï–í–û–ï!)
typescript// server/middleware/ml-middleware.ts

import { getSuggestedCategory, learnCategory } from '../services/ml-categories';

/**
 * Middleware: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç ML –∫–∞—Ç–µ–≥–æ—Ä–∏—é
 * –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ü–ï–†–ï–î —Å–æ–∑–¥–∞–Ω–∏–µ–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
 */
export async function applyMLCategory(
  userId: number,
  transactionData: {
    description: string;
    category?: string;
  }
): Promise<{
  description: string;
  category: string | undefined;
  mlSuggested: boolean;
  mlConfidence: number;
}> {
  // –ï—Å–ª–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è —É–∂–µ —É–∫–∞–∑–∞–Ω–∞ - –ø—Ä–æ–ø—É—Å–∫–∞–µ–º ML
  if (transactionData.category) {
    return {
      ...transactionData,
      mlSuggested: false,
      mlConfidence: 0
    };
  }
  
  // –ü–æ–ª—É—á–∏—Ç—å ML suggestion
  const suggestion = await getSuggestedCategory(
    userId,
    transactionData.description
  );
  
  if (suggestion) {
    // –ü—Ä–∏–º–µ–Ω–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¢–û–õ–¨–ö–û –µ—Å–ª–∏ confidence > 70%
    const shouldApply = suggestion.confidence >= 0.7;
    
    return {
      description: transactionData.description,
      category: shouldApply ? suggestion.category : undefined,
      mlSuggested: shouldApply,
      mlConfidence: suggestion.confidence
    };
  }
  
  // ML –Ω–µ –Ω–∞—à—ë–ª - –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –∫–∞–∫ –µ—Å—Ç—å
  return {
    ...transactionData,
    mlSuggested: false,
    mlConfidence: 0
  };
}

/**
 * Middleware: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—É—á–∞–µ—Ç ML –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è
 * –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ü–û–°–õ–ï —Å–æ–∑–¥–∞–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
 */
export async function trainMLCategory(
  userId: number,
  transactionData: {
    description: string;
    category?: string;
  }
): Promise<void> {
  // –û–±—É—á–∞–µ–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è —É–∫–∞–∑–∞–Ω–∞
  if (transactionData.category) {
    await learnCategory(
      userId,
      transactionData.description,
      transactionData.category
    );
  }
}
–†–∞–∑–º–µ—Ä: ~60 —Å—Ç—Ä–æ–∫ ‚úÖ
–õ–æ–≥–∏–∫–∞: –í—Å—è –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ ‚úÖ
–ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–æ—Å—Ç—å: 100% ‚úÖ

3. Transactions Service (—Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏—è!)
typescript// server/services/transaction.service.ts

import { db } from '../db/client';
import { transactions } from '@shared/schema';
import { applyMLCategory, trainMLCategory } from '../middleware/ml-middleware';

/**
 * –°–æ–∑–¥–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º ML
 * –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –í–ï–ó–î–ï: —Ñ–æ—Ä–º–∞, Telegram, OCR, voice
 */
export async function createTransaction(
  userId: number,
  data: {
    type: 'income' | 'expense';
    amount: number;
    description: string;
    category?: string;
    date: string;
    currency?: string;
    source?: string;
  }
) {
  // –®–ê–ì 1: –ü—Ä–∏–º–µ–Ω–∏—Ç—å ML –∫–∞—Ç–µ–≥–æ—Ä–∏—é (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
  const enhanced = await applyMLCategory(userId, {
    description: data.description,
    category: data.category
  });
  
  // –®–ê–ì 2: –°–æ–∑–¥–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
  const [transaction] = await db
    .insert(transactions)
    .values({
      userId,
      type: data.type,
      amount: data.amount,
      amountUsd: data.amount, // TODO: currency conversion
      description: enhanced.description,
      category: enhanced.category,
      date: data.date,
      currency: data.currency || 'USD',
      source: data.source || 'manual'
    })
    .returning();
  
  // –®–ê–ì 3: –û–±—É—á–∏—Ç—å ML (–µ—Å–ª–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è –±—ã–ª–∞ —É–∫–∞–∑–∞–Ω–∞)
  await trainMLCategory(userId, {
    description: transaction.description,
    category: transaction.category || undefined
  });
  
  return {
    ...transaction,
    mlSuggested: enhanced.mlSuggested,
    mlConfidence: enhanced.mlConfidence
  };
}
–†–∞–∑–º–µ—Ä: ~50 —Å—Ç—Ä–æ–∫ ‚úÖ
–í–µ—Å—å ML: –°–∫—Ä—ã—Ç –≤–Ω—É—Ç—Ä–∏ ‚úÖ
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: –û–¥–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è –≤–µ–∑–¥–µ ‚úÖ

4. API Endpoint (–û–î–ò–ù!)
typescript// server/routes/transactions.ts

import { createTransaction } from '../services/transaction.service';

/**
 * POST /api/transactions
 * –°–æ–∑–¥–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é (ML –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
 */
router.post('/', requireAuth, async (req, res) => {
  try {
    const userId = req.user.id;
    
    const transaction = await createTransaction(userId, {
      type: req.body.type,
      amount: req.body.amount,
      description: req.body.description,
      category: req.body.category, // –ú–æ–∂–µ—Ç –±—ã—Ç—å undefined
      date: req.body.date,
      currency: req.body.currency,
      source: 'manual'
    });
    
    res.status(201).json(transaction);
  } catch (error) {
    res.status(500).json({ error: 'Failed to create transaction' });
  }
});
–†–∞–∑–º–µ—Ä: ~20 —Å—Ç—Ä–æ–∫ ‚úÖ
ML –ª–æ–≥–∏–∫–∞: –ù–µ—Ç! –í—Å—ë –≤ service ‚úÖ

5. Frontend (–ü–†–û–°–¢–û–ô!)
tsx// components/TransactionForm.tsx

const createMutation = useMutation({
  mutationFn: async (data) => {
    // –ü—Ä–æ—Å—Ç–æ —Å–æ–∑–¥–∞—ë–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
    // ML —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞ backend!
    return await apiRequest('POST', '/api/transactions', data);
  },
  onSuccess: (transaction) => {
    // –ü–æ–∫–∞–∑–∞—Ç—å –µ—Å–ª–∏ ML –ø—Ä–∏–º–µ–Ω–∏–ª –∫–∞—Ç–µ–≥–æ—Ä–∏—é
    if (transaction.mlSuggested) {
      toast.success(
        `‚ú® Auto-categorized as "${transaction.category}" (${Math.round(transaction.mlConfidence * 100)}% confident)`
      );
    }
    
    queryClient.invalidateQueries({ queryKey: ['/api/transactions'] });
  }
});
–†–∞–∑–º–µ—Ä: ~15 —Å—Ç—Ä–æ–∫ ‚úÖ
ML –∫–æ–¥: –ù–ï–¢! ‚úÖ
–ü—Ä–æ—Å—Ç–æ —Å–æ–∑–¥–∞—ë–º: –î–∞ ‚úÖ

6. Telegram Bot
typescript// server/telegram/handlers.ts

import { createTransaction } from '../services/transaction.service';

bot.on('text', async (ctx) => {
  const userId = await getUserByTelegramId(ctx.from.id);
  
  // –ü–∞—Ä—Å–∏–º —Å–æ–æ–±—â–µ–Ω–∏–µ: "–∫—É–ø–∏–ª –∫–æ—Ñ–µ 300"
  const parsed = parseMessage(ctx.message.text);
  
  // –°–æ–∑–¥–∞—ë–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é (ML –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!)
  const transaction = await createTransaction(userId, {
    type: parsed.type,
    amount: parsed.amount,
    description: parsed.description,
    category: undefined, // ML —Å–∞–º –ø–æ–¥—Å—Ç–∞–≤–∏—Ç
    date: new Date().toISOString().split('T')[0],
    source: 'telegram'
  });
  
  // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
  ctx.reply(`
    ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ: ${transaction.amount} ${transaction.description}
    ${transaction.mlSuggested ? `‚ú® –ö–∞—Ç–µ–≥–æ—Ä–∏—è: ${transaction.category} (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)` : ''}
  `);
});
–†–∞–∑–º–µ—Ä: ~20 —Å—Ç—Ä–æ–∫ ‚úÖ
ML –∫–æ–¥: –ù–ï–¢! ‚úÖ
–†–∞–±–æ—Ç–∞–µ—Ç: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ ‚úÖ

7. OCR Service
typescript// server/services/ocr.service.ts

import { createTransaction } from './transaction.service';

export async function processReceipt(userId: number, imageBuffer: Buffer) {
  // 1. OCR —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ
  const ocrData = await recognizeReceipt(imageBuffer);
  
  // 2. –°–æ–∑–¥–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é (ML –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!)
  const transaction = await createTransaction(userId, {
    type: 'expense',
    amount: ocrData.amount,
    description: ocrData.merchant,
    category: undefined, // ML —Å–∞–º –ø–æ–¥—Å—Ç–∞–≤–∏—Ç
    date: ocrData.date,
    source: 'ocr'
  });
  
  return transaction;
}
```

**–†–∞–∑–º–µ—Ä:** ~15 —Å—Ç—Ä–æ–∫ ‚úÖ  
**ML –∫–æ–¥:** –ù–ï–¢! ‚úÖ

---

## üìä –°–†–ê–í–ù–ï–ù–ò–ï –ü–û–î–•–û–î–û–í

### ‚ùå –ò–°–•–û–î–ù–û–ï –¢–ó (–¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ):
```
TransactionForm.tsx    (20 —Å—Ç—Ä–æ–∫ ML –∫–æ–¥–∞)
telegram-bot.ts        (20 —Å—Ç—Ä–æ–∫ ML –∫–æ–¥–∞)
ocr-service.ts         (20 —Å—Ç—Ä–æ–∫ ML –∫–æ–¥–∞)
voice-handler.ts       (20 —Å—Ç—Ä–æ–∫ ML –∫–æ–¥–∞)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
–ò–¢–û–ì–û: 80 —Å—Ç—Ä–æ–∫ –ø–æ–≤—Ç–æ—Ä—è—é—â–µ–≥–æ—Å—è –∫–æ–¥–∞
```

### ‚úÖ –ú–û–Å –†–ï–®–ï–ù–ò–ï (—Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏—è):
```
ml-categories.ts       (100 —Å—Ç—Ä–æ–∫ - —Å–µ—Ä–≤–∏—Å)
ml-middleware.ts       (60 —Å—Ç—Ä–æ–∫ - middleware)
transaction.service.ts (50 —Å—Ç—Ä–æ–∫ - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç ML)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
TransactionForm.tsx    (0 —Å—Ç—Ä–æ–∫ ML –∫–æ–¥–∞!)
telegram-bot.ts        (0 —Å—Ç—Ä–æ–∫ ML –∫–æ–¥–∞!)
ocr-service.ts         (0 —Å—Ç—Ä–æ–∫ ML –∫–æ–¥–∞!)
voice-handler.ts       (0 —Å—Ç—Ä–æ–∫ ML –∫–æ–¥–∞!)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
–ò–¢–û–ì–û: 210 —Å—Ç—Ä–æ–∫ –≤ 3 —Ñ–∞–π–ª–∞—Ö (–æ–¥–∏–Ω —Ä–∞–∑!)
```

---

## üéØ –ü–†–ï–ò–ú–£–©–ï–°–¢–í–ê –ú–û–ï–ì–û –ü–û–î–•–û–î–ê

### 1. DRY (Don't Repeat Yourself)
```
‚úÖ ML –ª–æ–≥–∏–∫–∞ –≤ –û–î–ù–û–ú –º–µ—Å—Ç–µ
‚úÖ –î–æ–±–∞–≤–∏–ª 5-–π –∏—Å—Ç–æ—á–Ω–∏–∫? –†–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!
‚úÖ –ò–∑–º–µ–Ω–∏–ª ML? –ò—Å–ø—Ä–∞–≤–∏–ª –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ
```

### 2. –ü—Ä–æ—Å—Ç–æ—Ç–∞ –¥–ª—è Junior
```
‚úÖ Frontend: –ø—Ä–æ—Å—Ç–æ –≤—ã–∑—ã–≤–∞–µ—Ç createTransaction()
‚úÖ Telegram: –ø—Ä–æ—Å—Ç–æ –≤—ã–∑—ã–≤–∞–µ—Ç createTransaction()
‚úÖ OCR: –ø—Ä–æ—Å—Ç–æ –≤—ã–∑—ã–≤–∞–µ—Ç createTransaction()
‚úÖ Junior –ù–ï –¥—É–º–∞–µ—Ç –ø—Ä–æ ML - –æ–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!
```

### 3. –õ–µ–≥–∫–æ –¥–ª—è –ò–ò
```
‚úÖ –ú–∞–ª—ã–µ —Ñ–∞–π–ª—ã (<100 —Å—Ç—Ä–æ–∫ –∫–∞–∂–¥—ã–π)
‚úÖ –û–¥–∏–Ω —Ñ–∞–π–ª = –æ–¥–Ω–∞ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å
‚úÖ –ò–∑–º–µ–Ω–∏—Ç—å ML? –ü—Ä–∞–≤–∏—Ç—å ml-categories.ts
‚úÖ –ò–∑–º–µ–Ω–∏—Ç—å –ª–æ–≥–∏–∫—É —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π? –ü—Ä–∞–≤–∏—Ç—å transaction.service.ts
‚úÖ –ö–æ–Ω—Ç–µ–∫—Å—Ç –Ω–µ —Ç–µ—Ä—è–µ—Ç—Å—è!
```

### 4. –¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å
```
‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å ML? –¢–µ—Å—Ç–∏—Ä—É–π ml-categories.ts
‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å middleware? –¢–µ—Å—Ç–∏—Ä—É–π ml-middleware.ts
‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ? –¢–µ—Å—Ç–∏—Ä—É–π transaction.service.ts
‚úÖ –í—Å—ë –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ!

üìã –§–ò–ù–ê–õ–¨–ù–û–ï –¢–ó –î–õ–Ø REPLIT
markdown# üß† ML –ö–∞—Ç–µ–≥–æ—Ä–∏–π - –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥

## –ó–∞–¥–∞—á–∞
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–º–∏–Ω–∞—Ç—å –∏ –ø—Ä–∏–º–µ–Ω—è—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (3 —Ñ–∞–π–ª–∞)

### 1. ML –°–µ—Ä–≤–∏—Å (server/services/ml-categories.ts)

- normalize() - –æ—á–∏—Å—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞
- getSuggestedCategory() - –ø–æ–ª—É—á–∏—Ç—å –≤—ã—É—á–µ–Ω–Ω—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é
- learnCategory() - —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–≤—è–∑–∫—É

**–†–∞–∑–º–µ—Ä:** ~100 —Å—Ç—Ä–æ–∫

### 2. ML Middleware (server/middleware/ml-middleware.ts)

- applyMLCategory() - –ø—Ä–∏–º–µ–Ω–∏—Ç—å ML –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º
- trainMLCategory() - –æ–±—É—á–∏—Ç—å ML –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è

**–†–∞–∑–º–µ—Ä:** ~60 —Å—Ç—Ä–æ–∫

### 3. Transaction Service (server/services/transaction.service.ts)

- createTransaction() - —Å–æ–∑–¥–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é + ML –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

**–†–∞–∑–º–µ—Ä:** ~50 —Å—Ç—Ä–æ–∫

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

**–í–°–ï –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –û–î–ù–£ —Ñ—É–Ω–∫—Ü–∏—é:**
```typescript
// Frontend, Telegram, OCR, Voice - –í–ï–ó–î–ï:
const transaction = await createTransaction(userId, {
  type: 'expense',
  amount: 500,
  description: 'Starbucks',
  category: undefined, // ML —Å–∞–º –ø–æ–¥—Å—Ç–∞–≤–∏—Ç!
  date: '2025-11-09',
  source: 'manual'
});

// ML —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
// 1. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –±–∞–∑—É –∑–Ω–∞–Ω–∏–π
// 2. –ü—Ä–∏–º–µ–Ω—è–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏—é –µ—Å–ª–∏ confidence > 70%
// 3. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤—ã–±–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```

## –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
```sql
CREATE TABLE merchant_categories (
  id SERIAL PRIMARY KEY,
  userId INTEGER REFERENCES users(id) ON DELETE CASCADE,
  merchantName VARCHAR(255) NOT NULL,
  categoryName VARCHAR(50) NOT NULL,
  usageCount INTEGER DEFAULT 1,
  lastUsedAt TIMESTAMP DEFAULT NOW(),
  createdAt TIMESTAMP DEFAULT NOW()
);
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. –°–æ–∑–¥–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é "Starbucks" ‚Üí –≤—ã–±—Ä–∞—Ç—å "–ö–æ—Ñ–µ–π–Ω–∏"
2. –°–æ–∑–¥–∞—Ç—å —Å–Ω–æ–≤–∞ "starbucks" ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ "–ö–æ—Ñ–µ–π–Ω–∏" ‚ú®
3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å 5 —Ä–∞–∑ ‚Üí confidence 95%

## –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞

- ‚úÖ –í—Å—è ML –ª–æ–≥–∏–∫–∞ –≤ 3 —Ñ–∞–π–ª–∞—Ö
- ‚úÖ Frontend –ù–ï –∑–Ω–∞–µ—Ç –ø—Ä–æ ML
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –≤—Å–µ—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
- ‚úÖ –§–∞–π–ª—ã <100 —Å—Ç—Ä–æ–∫
- ‚úÖ Junior –ø–æ–Ω–∏–º–∞–µ—Ç –∑–∞ 15 –º–∏–Ω—É—Ç

---

**–†–ï–ê–õ–ò–ó–£–ô –ü–û –≠–¢–û–ú–£ –ü–õ–ê–ù–£!**