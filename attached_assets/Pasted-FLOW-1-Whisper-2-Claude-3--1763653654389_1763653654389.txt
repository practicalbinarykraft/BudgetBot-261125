FLOW:
1. Whisper —Ä–∞—Å–ø–æ–∑–Ω–∞—ë—Ç –≥–æ–ª–æ—Å ‚Üí —Ç–µ–∫—Å—Ç (–∫–∞–∫ –µ—Å—Ç—å)
2. Claude –ø–æ–Ω–∏–º–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏ –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç
3. –°–æ–∑–¥–∞—ë—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è

–ü–†–ï–ò–ú–£–©–ï–°–¢–í–ê:
‚úÖ –ü–æ–Ω–∏–º–∞–µ—Ç "150 —Ç—ã—Å—è—á" = 150,000
‚úÖ –†–∞—Å–ø–æ–∑–Ω–∞—ë—Ç –≤–∞–ª—é—Ç—É ("—Ä—É–ø–∏–π" = IDR)
‚úÖ –ò–∑–≤–ª–µ–∫–∞–µ—Ç –º–∞–≥–∞–∑–∏–Ω ("–°—Ç–∞—Ä–±–∞–∫—Å" = Starbucks)
‚úÖ –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é (–∫–æ—Ñ–µ = –ö–∞—Ñ–µ, –Ω–µ –ü—Ä–æ–¥—É–∫—Ç—ã)
‚úÖ –£–±–∏—Ä–∞–µ—Ç –ª–∏—à–Ω–∏–µ —Å–ª–æ–≤–∞

üìã –†–ï–ê–õ–ò–ó–ê–¶–ò–Ø (2 –®–ê–ì–ê)
–®–ê–ì 1: –°–û–ó–î–ê–¢–¨ AI NORMALIZER SERVICE (20 –º–∏–Ω—É—Ç)
typescript‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
–°–û–ó–î–ê–¢–¨ –§–ê–ô–õ: server/services/voice-transaction-normalizer.service.ts
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

import Anthropic from '@anthropic-ai/sdk';

interface NormalizedTransaction {
  amount: number;
  currency: 'USD' | 'RUB' | 'IDR';
  description: string;
  category?: string;
  merchantName?: string;
  type: 'income' | 'expense';
  confidence: 'high' | 'medium' | 'low';
}

export class VoiceTransactionNormalizer {
  
  // –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—é –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
  async normalize(params: {
    transcribedText: string;
    userRegion?: string; // 'russia', 'indonesia-bali', etc
    anthropicApiKey: string;
  }): Promise<NormalizedTransaction> {
    
    const { transcribedText, userRegion, anthropicApiKey } = params;
    
    const anthropic = new Anthropic({
      apiKey: anthropicApiKey
    });
    
    // –ü—Ä–æ–º–ø—Ç –¥–ª—è Claude
    const prompt = `–¢—ã –ø–æ–º–æ—â–Ω–∏–∫ –¥–ª—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø–∏—Å–∞–ª –≥–æ–ª–æ—Å–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ —Å–≤–æ–∏—Ö —Ç—Ä–∞—Ç–∞—Ö –∏–ª–∏ –¥–æ—Ö–æ–¥–∞—Ö.

–†–ï–ì–ò–û–ù –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø: ${userRegion || 'unknown'}

–¢–†–ê–ù–°–ö–†–ò–ü–¶–ò–Ø –ì–û–õ–û–°–û–í–û–ì–û –°–û–û–ë–©–ï–ù–ò–Ø:
"${transcribedText}"

–¢–í–û–Ø –ó–ê–î–ê–ß–ê:
–ò–∑–≤–ª–µ—á—å –∏–∑ —ç—Ç–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Ñ–∏–Ω–∞–Ω—Å–æ–≤—É—é —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é.

–ü–†–ê–í–ò–õ–ê:
1. –°–£–ú–ú–ê:
   - "150 —Ç—ã—Å—è—á" = 150000
   - "–ø–æ–ª—Ç–æ—Ä–∞ –º–∏–ª–ª–∏–æ–Ω–∞" = 1500000
   - "–ø—è—Ç—å—Å–æ—Ç" = 500
   - "—Ç—ã—â–∞" = 1000
   - –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–π —Å–ª–æ–≤–∞–º–∏ –≤ —á–∏—Å–ª–∞

2. –í–ê–õ–Æ–¢–ê:
   - "—Ä—É–±–ª–µ–π" / "—Ä—É–±–ª—è" / "—Ä—É–±" = RUB
   - "—Ä—É–ø–∏–π" / "—Ä—É–ø–∏–∏" / "–∏–Ω–¥–æ–Ω–µ–∑–∏–π—Å–∫–∏—Ö" = IDR
   - "–¥–æ–ª–ª–∞—Ä–æ–≤" / "–±–∞–∫—Å–æ–≤" / "usd" = USD
   - –ï—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω–∞, —É–≥–∞–¥–∞–π –ø–æ —Ä–µ–≥–∏–æ–Ω—É:
     * russia ‚Üí RUB
     * indonesia ‚Üí IDR
     * default ‚Üí USD

3. –û–ü–ò–°–ê–ù–ò–ï:
   - –°–¥–µ–ª–∞–π –∫–æ—Ä–æ—Ç–∫–∏–º –∏ –ø–æ–Ω—è—Ç–Ω—ã–º
   - –£–±–µ—Ä–∏ –ª–∏—à–Ω–∏–µ —Å–ª–æ–≤–∞ —Ç–∏–ø–∞ "–∫—É–ø–∏–ª", "–ø–æ—Ç—Ä–∞—Ç–∏–ª", "–∑–∞–ø–ª–∞—Ç–∏–ª"
   - "–ö—É–ø–∏–ª –∫–æ—Ñ–µ –≤ –°—Ç–∞—Ä–±–∞–∫—Å–µ" ‚Üí "–ö–æ—Ñ–µ Starbucks"
   - "–ó–∞–ø—Ä–∞–≤–∏–ª—Å—è –Ω–∞ –±–µ–Ω–∑–∏–Ω" ‚Üí "–ë–µ–Ω–∑–∏–Ω"
   - –ò—Å–ø—Ä–∞–≤—å –Ω–∞–∑–≤–∞–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–æ–≤ –Ω–∞ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ –Ω–∞–ø–∏—Å–∞–Ω–∏–µ

4. –ö–ê–¢–ï–ì–û–†–ò–Ø:
   - –û–ø—Ä–µ–¥–µ–ª–∏ –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
   - –í–∞—Ä–∏–∞–Ω—Ç—ã: –ü—Ä–æ–¥—É–∫—Ç—ã, –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç, –ö–∞—Ñ–µ/–†–µ—Å—Ç–æ—Ä–∞–Ω—ã, –†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è, –ó–¥–æ—Ä–æ–≤—å–µ, –û–¥–µ–∂–¥–∞, –î–æ–º, –ü—Ä–æ—á–µ–µ

5. –ú–ê–ì–ê–ó–ò–ù (–µ—Å–ª–∏ —É–ø–æ–º—è–Ω—É—Ç):
   - "–°—Ç–∞—Ä–±–∞–∫—Å" ‚Üí "Starbucks"
   - "–ü—è—Ç—ë—Ä–æ—á–∫–∞" ‚Üí "–ü—è—Ç—ë—Ä–æ—á–∫–∞"
   - "–ò–Ω–¥–æ–º–∞—Ä–µ—Ç" ‚Üí "Indomaret"

6. –¢–ò–ü:
   - –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é expense (—Ä–∞—Å—Ö–æ–¥)
   - –ï—Å–ª–∏ —É–ø–æ–º—è–Ω—É—Ç—ã —Å–ª–æ–≤–∞ "–ø–æ–ª—É—á–∏–ª", "–∑–∞—Ä–ø–ª–∞—Ç–∞", "–¥–æ—Ö–æ–¥" ‚Üí income

–û–¢–í–ï–¢ –í–ï–†–ù–ò –°–¢–†–û–ì–û –í JSON:
{
  "amount": 150000,
  "currency": "IDR",
  "description": "–ö–æ—Ñ–µ Starbucks",
  "category": "–ö–∞—Ñ–µ/–†–µ—Å—Ç–æ—Ä–∞–Ω—ã",
  "merchantName": "Starbucks",
  "type": "expense",
  "confidence": "high"
}

CONFIDENCE:
- high: –≤—Å—ë –ø–æ–Ω—è—Ç–Ω–æ –∏–∑ —Ç–µ–∫—Å—Ç–∞
- medium: –ø—Ä–∏—à–ª–æ—Å—å —É–≥–∞–¥—ã–≤–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é/–≤–∞–ª—é—Ç—É
- low: —Ç–µ–∫—Å—Ç –Ω–µ–ø–æ–Ω—è—Ç–Ω—ã–π –∏–ª–∏ –¥–∞–Ω–Ω—ã—Ö –º–∞–ª–æ`;

    try {
      const message = await anthropic.messages.create({
        model: 'claude-sonnet-4-20250514',
        max_tokens: 1024,
        messages: [{
          role: 'user',
          content: prompt
        }]
      });
      
      const responseText = message.content[0].type === 'text' 
        ? message.content[0].text 
        : '';
      
      // –ò–∑–≤–ª–µ—á—å JSON –∏–∑ –æ—Ç–≤–µ—Ç–∞
      const jsonMatch = responseText.match(/\{[\s\S]*\}/);
      if (!jsonMatch) {
        throw new Error('Claude did not return valid JSON');
      }
      
      const normalized: NormalizedTransaction = JSON.parse(jsonMatch[0]);
      
      console.log('‚úÖ Voice transaction normalized:', normalized);
      
      return normalized;
      
    } catch (error) {
      console.error('‚ùå Voice normalization failed:', error);
      
      // Fallback: –ø—Ä–æ—Å—Ç–æ–π –ø–∞—Ä—Å–∏–Ω–≥
      return this.fallbackParse(transcribedText);
    }
  }
  
  // Fallback –µ—Å–ª–∏ Claude –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
  private fallbackParse(text: string): NormalizedTransaction {
    // –ü—Ä–æ—Å—Ç–æ–π regex –ø–∞—Ä—Å–∏–Ω–≥ (–∫–∞–∫ —Å–µ–π—á–∞—Å)
    const amountMatch = text.match(/(\d+[\s,]?\d*)/);
    const amount = amountMatch ? parseFloat(amountMatch[1].replace(/[\s,]/g, '')) : 0;
    
    const currency = text.includes('—Ä—É–ø–∏') ? 'IDR' 
                   : text.includes('—Ä—É–±–ª') ? 'RUB' 
                   : 'USD';
    
    return {
      amount,
      currency,
      description: text.slice(0, 100),
      type: 'expense',
      confidence: 'low'
    };
  }
}

export const voiceTransactionNormalizer = new VoiceTransactionNormalizer();

–°–¢–†–û–ö: ~180 ‚úÖ

–®–ê–ì 2: –ò–ù–¢–ï–ì–†–ò–†–û–í–ê–¢–¨ –í TELEGRAM BOT (15 –º–∏–Ω—É—Ç)
typescript‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
–û–ë–ù–û–í–ò–¢–¨: server/telegram/commands.ts (voice handler)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

–ù–ê–ô–¢–ò:
// 7. –û–±—Ä–∞–±–æ—Ç–∞—Ç—å —Ç–µ–∫—Å—Ç –∫–∞–∫ –æ–±—ã—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
const text = transcription.text.trim();

if (!text) {
  await bot.sendMessage(chatId, '‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å —Ç–µ–∫—Å—Ç');
  return;
}

await bot.sendMessage(chatId, 
  `‚úÖ –†–∞—Å–ø–æ–∑–Ω–∞–Ω–æ: "${text}"\n\n` +
  '–û–±—Ä–∞–±–∞—Ç—ã–≤–∞—é...'
);

–ó–ê–ú–ï–ù–ò–¢–¨ –ù–ê:

// 7. –û–±—Ä–∞–±–æ—Ç–∞—Ç—å —Ç–µ–∫—Å—Ç –£–ú–ù–û —á–µ—Ä–µ–∑ AI
const text = transcription.text.trim();

if (!text) {
  await bot.sendMessage(chatId, '‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å —Ç–µ–∫—Å—Ç');
  return;
}

// –ü–æ–∫–∞–∑–∞—Ç—å —á—Ç–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–ª–∏
await bot.sendMessage(chatId, 
  `üé§ –†–∞—Å–ø–æ–∑–Ω–∞–Ω–æ: "${text}"\n\n` +
  'ü§ñ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—é —á–µ—Ä–µ–∑ AI...'
);

// –ù–û–í–û–ï: AI –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è
import { voiceTransactionNormalizer } from '../services/voice-transaction-normalizer.service';

try {
  // –ü–æ–ª—É—á–∏—Ç—å Anthropic –∫–ª—é—á
  const anthropicApiKey = settings?.anthropicApiKey;
  
  if (!anthropicApiKey) {
    // Fallback –Ω–∞ –ø—Ä–æ—Å—Ç–æ–π –ø–∞—Ä—Å–∏–Ω–≥ –µ—Å–ª–∏ –Ω–µ—Ç –∫–ª—é—á–∞
    const parsed = parseTransactionText(text);
    // ... –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ —Ä–∞–Ω—å—à–µ
    return;
  }
  
  // –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ä–µ–≥–∏–æ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  const userLocation = await locationService.getUserLocation(userId);
  const region = userLocation?.region || 'unknown';
  
  // AI –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è
  const normalized = await voiceTransactionNormalizer.normalize({
    transcribedText: text,
    userRegion: region,
    anthropicApiKey: anthropicApiKey
  });
  
  console.log('‚úÖ Normalized transaction:', normalized);
  
  // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ USD (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
  const exchangeRates = await getExchangeRates();
  const amountUsd = normalized.currency === 'USD' 
    ? normalized.amount
    : normalized.amount / exchangeRates[normalized.currency];
  
  // –ù–∞–π—Ç–∏/—Å–æ–∑–¥–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é
  let categoryId = null;
  if (normalized.category) {
    const category = await findOrCreateCategory({
      userId,
      name: normalized.category,
      type: normalized.type
    });
    categoryId = category.id;
  }
  
  // –°–æ–∑–¥–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
  const transaction = await storage.createTransaction({
    userId,
    type: normalized.type,
    amount: amountUsd.toString(),
    amountOriginal: normalized.amount.toString(),
    currency: 'USD',
    currencyOriginal: normalized.currency,
    description: normalized.description,
    categoryId,
    merchantName: normalized.merchantName,
    date: new Date().toISOString().split('T')[0],
    source: 'telegram_voice'
  });
  
  // –î–æ–±–∞–≤–∏—Ç—å –≤ –∫–∞—Ç–∞–ª–æ–≥ (–µ—Å–ª–∏ –µ—Å—Ç—å –º–∞–≥–∞–∑–∏–Ω)
  if (normalized.merchantName) {
    await processReceiptItems({
      receiptItems: [{
        name: normalized.description,
        price: normalized.amount,
        priceUsd: amountUsd,
        priceOriginal: normalized.amount,
        currencyOriginal: normalized.currency
      }],
      userId,
      storeName: normalized.merchantName,
      purchaseDate: new Date().toISOString().split('T')[0],
      currency: normalized.currency
    });
  }
  
  // –°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–≤–µ—Ç
  let message = `‚úÖ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∞!\n\n`;
  message += `üí∞ –°—É–º–º–∞: ${normalized.amount.toLocaleString()} ${normalized.currency}`;
  
  if (normalized.currency !== 'USD') {
    message += ` (‚âà $${amountUsd.toFixed(2)} USD)`;
  }
  
  message += `\nüìù –û–ø–∏—Å–∞–Ω–∏–µ: ${normalized.description}`;
  
  if (normalized.category) {
    message += `\nüìÇ –ö–∞—Ç–µ–≥–æ—Ä–∏—è: ${normalized.category}`;
  }
  
  if (normalized.merchantName) {
    message += `\nüè™ –ú–∞–≥–∞–∑–∏–Ω: ${normalized.merchantName}`;
  }
  
  if (normalized.confidence === 'medium' || normalized.confidence === 'low') {
    message += `\n\n‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∞–Ω–Ω—ã–µ - AI –º–æ–≥ –æ—à–∏–±–∏—Ç—å—Å—è`;
  }
  
  await bot.sendMessage(chatId, message, {
    reply_markup: {
      inline_keyboard: [[
        { text: '‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å', callback_data: `edit_${transaction.id}` },
        { text: 'üóëÔ∏è –£–¥–∞–ª–∏—Ç—å', callback_data: `delete_${transaction.id}` }
      ]]
    }
  });
  
} catch (error) {
  console.error('‚ùå AI normalization failed:', error);
  
  // Fallback –Ω–∞ –ø—Ä–æ—Å—Ç–æ–π –ø–∞—Ä—Å–∏–Ω–≥
  await bot.sendMessage(chatId, 
    '‚ö†Ô∏è AI –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ —É–¥–∞–ª–∞—Å—å, –∏—Å–ø–æ–ª—å–∑—É—é –ø—Ä–æ—Å—Ç–æ–π –ø–∞—Ä—Å–∏–Ω–≥...'
  );
  
  const parsed = parseTransactionText(text);
  // ... –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ —Ä–∞–Ω—å—à–µ
}

–î–û–ë–ê–í–õ–Ø–ï–ú–´–• –°–¢–†–û–ö: ~100 ‚úÖ

–ò–ú–ü–û–†–¢–´ –î–û–ë–ê–í–ò–¢–¨:
import { voiceTransactionNormalizer } from '../services/voice-transaction-normalizer.service';
import { locationService } from '../services/location.service';
import { processReceiptItems } from '../services/product-catalog.service';
```

---

## üéØ –†–ï–ó–£–õ–¨–¢–ê–¢ (–î–û/–ü–û–°–õ–ï)

### **–î–û (–î–û–°–õ–û–í–ù–û):**
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≥–æ–≤–æ—Ä–∏—Ç:
"–ö—É–ø–∏–ª –∫–æ—Ñ–µ –≤ –°—Ç–∞—Ä–±–∞–∫—Å–µ, 150 —Ç—ã—Å—è—á —Ä—É–ø–∏–π –∏–Ω–¥–æ–Ω–µ–∑–∏–π—Å–∫–∏—Ö"

–ë–æ—Ç —Å–æ–∑–¥–∞—ë—Ç: ‚ùå
- –û–ø–∏—Å–∞–Ω–∏–µ: "–ö—É–ø–∏–ª –∫–æ—Ñ–µ –≤ —Å—Ç–∞—Ä–±–∞–∫—Å–µ —Ç—ã—Å—è—á —Ä—É–ø–∏–π –∏–Ω–¥–æ–Ω–µ–∑–∏–π—Å–∫–∏—Ö"
- –°—É–º–º–∞: $150.00 USD (–ù–ï–ü–†–ê–í–ò–õ–¨–ù–û!)
- –ö–∞—Ç–µ–≥–æ—Ä–∏—è: –ü—Ä–æ–¥—É–∫—Ç—ã
- –ú–∞–≥–∞–∑–∏–Ω: –Ω–µ —É–∫–∞–∑–∞–Ω
```

### **–ü–û–°–õ–ï (–£–ú–ù–û):**
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≥–æ–≤–æ—Ä–∏—Ç:
"–ö—É–ø–∏–ª –∫–æ—Ñ–µ –≤ –°—Ç–∞—Ä–±–∞–∫—Å–µ, 150 —Ç—ã—Å—è—á —Ä—É–ø–∏–π –∏–Ω–¥–æ–Ω–µ–∑–∏–π—Å–∫–∏—Ö"

AI –ø–æ–Ω–∏–º–∞–µ—Ç: ‚úÖ
- "150 —Ç—ã—Å—è—á" = 150,000
- "—Ä—É–ø–∏–π –∏–Ω–¥–æ–Ω–µ–∑–∏–π—Å–∫–∏—Ö" = IDR
- "–°—Ç–∞—Ä–±–∞–∫—Å–µ" = Starbucks
- –∫–æ–Ω—Ç–µ–∫—Å—Ç "–∫–æ—Ñ–µ" = –ö–∞—Ñ–µ/–†–µ—Å—Ç–æ—Ä–∞–Ω—ã

–ë–æ—Ç —Å–æ–∑–¥–∞—ë—Ç: ‚úÖ
- –û–ø–∏—Å–∞–Ω–∏–µ: "–ö–æ—Ñ–µ Starbucks"
- –°—É–º–º–∞: 150,000 IDR (‚âà $9.38 USD)
- –ö–∞—Ç–µ–≥–æ—Ä–∏—è: –ö–∞—Ñ–µ/–†–µ—Å—Ç–æ—Ä–∞–Ω—ã
- –ú–∞–≥–∞–∑–∏–Ω: Starbucks
- –¢–æ–≤–∞—Ä –¥–æ–±–∞–≤–ª–µ–Ω –≤ Product Catalog ‚úÖ
```

---

## üß™ –ü–†–ò–ú–ï–†–´ –û–ë–†–ê–ë–û–¢–ö–ò

### **–ü–†–ò–ú–ï–† 1: –†–ê–ó–ì–û–í–û–†–ù–´–ô –Ø–ó–´–ö**
```
–ì–æ–ª–æ—Å: "–ù—É –≤–æ—Ç, –∑–∞–ø—Ä–∞–≤–∏–ª—Å—è —Å–µ–≥–æ–¥–Ω—è, —Ç—ã—â–∞ —Ä—É–±–ª–µ–π –ø—Ä–∏–º–µ—Ä–Ω–æ"

AI –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç:
{
  "amount": 1000,
  "currency": "RUB",
  "description": "–ë–µ–Ω–∑–∏–Ω",
  "category": "–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç",
  "type": "expense",
  "confidence": "high"
}
```

### **–ü–†–ò–ú–ï–† 2: –°–õ–û–ñ–ù–´–ï –ß–ò–°–õ–ê**
```
–ì–æ–ª–æ—Å: "–ö—É–ø–∏–ª –Ω–æ–≤—ã–π –∞–π—Ñ–æ–Ω, —Å—Ç–æ –ø—è—Ç—å–¥–µ—Å—è—Ç —Ç—ã—Å—è—á —Ä—É–±–ª–µ–π"

AI –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç:
{
  "amount": 150000,
  "currency": "RUB",
  "description": "iPhone",
  "category": "–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞",
  "type": "expense",
  "confidence": "high"
}
```

### **–ü–†–ò–ú–ï–† 3: –° –ú–ê–ì–ê–ó–ò–ù–û–ú**
```
–ì–æ–ª–æ—Å: "–°—Ö–æ–¥–∏–ª –≤ –ü—è—Ç—ë—Ä–æ—á–∫—É, –Ω–∞–∫—É–ø–∏–ª –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –Ω–∞ —Ç—Ä–∏ —Ç—ã—Å—è—á–∏"

AI –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç:
{
  "amount": 3000,
  "currency": "RUB",
  "description": "–ü—Ä–æ–¥—É–∫—Ç—ã",
  "category": "–ü—Ä–æ–¥—É–∫—Ç—ã –ø–∏—Ç–∞–Ω–∏—è",
  "merchantName": "–ü—è—Ç—ë—Ä–æ—á–∫–∞",
  "type": "expense",
  "confidence": "high"
}
```

### **–ü–†–ò–ú–ï–† 4: –î–û–•–û–î**
```
–ì–æ–ª–æ—Å: "–ü–æ–ª—É—á–∏–ª –∞–≤–∞–Ω—Å, –ø—è—Ç—å–¥–µ—Å—è—Ç —Ç—ã—Å—è—á"

AI –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç:
{
  "amount": 50000,
  "currency": "RUB",
  "description": "–ê–≤–∞–Ω—Å",
  "category": "–ó–∞—Ä–ø–ª–∞—Ç–∞",
  "type": "income",
  "confidence": "high"
}
```

### **–ü–†–ò–ú–ï–† 5: –ë–ï–ó –í–ê–õ–Æ–¢–´ (–£–ì–ê–î–´–í–ê–ù–ò–ï)**
```
–ì–æ–ª–æ—Å: "–ö—É–ø–∏–ª –ø–∏—Ü—Ü—É, –¥–≤–µ—Å—Ç–∏"
–†–µ–≥–∏–æ–Ω: indonesia-bali

AI –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç:
{
  "amount": 200,
  "currency": "IDR",  // —É–≥–∞–¥–∞–ª –ø–æ —Ä–µ–≥–∏–æ–Ω—É
  "description": "–ü–∏—Ü—Ü–∞",
  "category": "–ö–∞—Ñ–µ/–†–µ—Å—Ç–æ—Ä–∞–Ω—ã",
  "type": "expense",
  "confidence": "medium"  // —É–≥–∞–¥–∞–ª –≤–∞–ª—é—Ç—É
}
```

---

## üí∞ –°–¢–û–ò–ú–û–°–¢–¨
```
WHISPER: $0.006/–º–∏–Ω—É—Ç–∞
CLAUDE: ~$0.001-0.003 –∑–∞ –∑–∞–ø—Ä–æ—Å (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –¥–ª–∏–Ω—ã)

–ü–†–ò–ú–ï–† –ì–û–õ–û–°–û–í–û–ì–û –°–û–û–ë–©–ï–ù–ò–Ø:
- 10 —Å–µ–∫—É–Ω–¥ –≥–æ–ª–æ—Å–∞
- Whisper: $0.001
- Claude: $0.002
- –ò–¢–û–ì–û: $0.003

–ï–°–õ–ò 100 –ì–û–õ–û–°–û–í–´–•/–ú–ï–°–Ø–¶:
100 √ó $0.003 = $0.30/–º–µ—Å—è—Ü

–î–Å–®–ï–í–û! ‚úÖ
```

---

## ‚ö° –ü–†–ï–ò–ú–£–©–ï–°–¢–í–ê AI –ü–û–î–•–û–î–ê
```
‚úÖ –ü–û–ù–ò–ú–ê–ï–¢ –ö–û–ù–¢–ï–ö–°–¢
   "–ö—É–ø–∏–ª –∫–æ—Ñ–µ –≤ –°—Ç–∞—Ä–±–∞–∫—Å–µ"
   ‚Üí –ö–∞—Ç–µ–≥–æ—Ä–∏—è: –ö–∞—Ñ–µ/–†–µ—Å—Ç–æ—Ä–∞–Ω—ã (–Ω–µ –ü—Ä–æ–¥—É–∫—Ç—ã!)

‚úÖ –ö–û–ù–í–ï–†–¢–ò–†–£–ï–¢ –ß–ò–°–õ–ê –°–õ–û–í–ê–ú–ò
   "150 —Ç—ã—Å—è—á" ‚Üí 150,000
   "–ø–æ–ª—Ç–æ—Ä–∞ –º–∏–ª–ª–∏–æ–Ω–∞" ‚Üí 1,500,000

‚úÖ –†–ê–°–ü–û–ó–ù–ê–Å–¢ –í–ê–õ–Æ–¢–£ –ò–ó –°–õ–û–í
   "—Ä—É–ø–∏–π" ‚Üí IDR
   "–±–∞–∫—Å–æ–≤" ‚Üí USD

‚úÖ –ò–ó–í–õ–ï–ö–ê–ï–¢ –ú–ê–ì–ê–ó–ò–ù
   "–≤ –°—Ç–∞—Ä–±–∞–∫—Å–µ" ‚Üí merchantName: "Starbucks"

‚úÖ –ò–°–ü–†–ê–í–õ–Ø–ï–¢ –û–ü–ï–ß–ê–¢–ö–ò/–ü–†–û–ò–ó–ù–û–®–ï–ù–ò–ï
   "–°—Ç–∞—Ä–±–∞–∫—Å" ‚Üí "Starbucks"
   "–ü—è—Ç—ë—Ä–æ—á–∫–∞" ‚Üí "–ü—è—Ç—ë—Ä–æ—á–∫–∞" (–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –Ω–∞–ø–∏—Å–∞–Ω–∏–µ)

‚úÖ –£–ë–ò–†–ê–ï–¢ –õ–ò–®–ù–ò–ï –°–õ–û–í–ê
   "–ù—É –≤–æ—Ç –∫—É–ø–∏–ª –∫–æ—Ñ–µ –≤ –æ–±—â–µ–º"
   ‚Üí "–ö–æ—Ñ–µ"

‚úÖ –û–ü–†–ï–î–ï–õ–Ø–ï–¢ –¢–ò–ü
   "–ü–æ–ª—É—á–∏–ª –∑–∞—Ä–ø–ª–∞—Ç—É" ‚Üí type: income
   "–ü–æ—Ç—Ä–∞—Ç–∏–ª" ‚Üí type: expense

‚úÖ FALLBACK
   –ï—Å–ª–∏ Claude –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚Üí –ø—Ä–æ—Å—Ç–æ–π –ø–∞—Ä—Å–∏–Ω–≥
```

---

## üéØ –ò–¢–û–ì–û: –ß–¢–û –ú–ï–ù–Ø–¢–¨
```
–§–ê–ô–õ–û–í: 2
–í–†–ï–ú–ï–ù–ò: 35 –º–∏–Ω—É—Ç

–®–ê–ì 1: –°–æ–∑–¥–∞—Ç—å VoiceTransactionNormalizer (~180 —Å—Ç—Ä–æ–∫)
–®–ê–ì 2: –û–±–Ω–æ–≤–∏—Ç—å voice handler (~100 —Å—Ç—Ä–æ–∫)

–†–ï–ó–£–õ–¨–¢–ê–¢:
‚ùå –ë–´–õ–û: –î–æ—Å–ª–æ–≤–Ω–∞—è —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è ‚Üí –ø–ª–æ—Ö–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
‚úÖ –°–¢–ê–õ–û: AI –ø–æ–Ω–∏–º–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç ‚Üí –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

–ë–û–ù–£–°–´:
+ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –≤ Product Catalog
+ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –≤–∞–ª—é—Ç–∞ (IDR, –Ω–µ USD)
+ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è
+ –ò–∑–≤–ª–µ–∫–∞–µ—Ç –º–∞–≥–∞–∑–∏–Ω
+ –£–º–µ–µ—Ç "150 —Ç—ã—Å—è—á" = 150,000