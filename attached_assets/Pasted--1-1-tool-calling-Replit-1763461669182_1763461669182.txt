üéØ –®–ê–ì 1: –ò–ù–§–†–ê–°–¢–†–£–ö–¢–£–†–ê (1 –î–ï–ù–¨)
–¶–µ–ª—å: –°–æ–∑–¥–∞—Ç—å –±–∞–∑–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è tool calling
–ó–∞–¥–∞—á–∞ –¥–ª—è Replit:
–°–æ–∑–¥–∞–π –±–∞–∑–æ–≤—É—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è AI tool calling.

–§–ê–ô–õ–´ (4 —Ñ–∞–π–ª–∞, ~200 —Å—Ç—Ä–æ–∫):

1. server/ai/tool-types.ts (50 —Å—Ç—Ä–æ–∫):
---
export type ToolName = 
  | 'get_balance'
  | 'create_category'
  | 'add_transaction';

export interface Tool {
  name: ToolName;
  description: string;
  requiresConfirmation: boolean; // false = –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å—Ä–∞–∑—É, true = –∑–∞–ø—Ä–æ—Å–∏—Ç—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
  input_schema: {
    type: 'object';
    properties: Record<string, any>;
    required: string[];
  };
}

export interface ToolResult {
  success: boolean;
  data?: any;
  error?: string;
}

export interface ToolConfirmation {
  action: ToolName;
  params: Record<string, any>;
  preview: string;
}
---

2. server/ai/tools.ts (50 —Å—Ç—Ä–æ–∫):
---
import { Tool } from './tool-types';

export const TOOLS: Tool[] = [
  {
    name: 'get_balance',
    description: 'Get current user balance and total capital',
    requiresConfirmation: false, // –ß–∏—Ç–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ - –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
    input_schema: {
      type: 'object',
      properties: {},
      required: []
    }
  }
];
---

3. server/ai/tool-executor.ts (50 —Å—Ç—Ä–æ–∫):
---
import { ToolName, ToolResult } from './tool-types';

export async function executeTool(
  toolName: ToolName,
  params: Record<string, any>,
  userId: number
): Promise<ToolResult> {
  try {
    switch (toolName) {
      case 'get_balance':
        // –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è —Ç–µ—Å—Ç–∞
        return {
          success: true,
          data: { balance: 0, message: 'Tool infrastructure ready' }
        };
      
      default:
        return {
          success: false,
          error: `Unknown tool: ${toolName}`
        };
    }
  } catch (error: any) {
    return {
      success: false,
      error: error.message
    };
  }
}
---

4. server/ai/chat-with-tools.ts (50 —Å—Ç—Ä–æ–∫):
---
import Anthropic from '@anthropic-ai/sdk';
import { TOOLS } from './tools';
import { repositories } from '../repositories';

export async function chatWithTools(
  message: string,
  userId: number
) {
  // –ü–æ–ª—É—á–∏—Ç—å API –∫–ª—é—á –Æ–ó–ï–†–ê –∏–∑ –ë–î (BYOK)
  const settings = await repositories.settings.findByUser(userId);
  
  if (!settings?.anthropicApiKey) {
    throw new Error('API key not configured. Please add your Anthropic API key in Settings.');
  }
  
  // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–ª—é—á —é–∑–µ—Ä–∞
  const anthropic = new Anthropic({ 
    apiKey: settings.anthropicApiKey 
  });
  
  // –í—ã–∑–≤–∞—Ç—å Claude —Å tools
  const response = await anthropic.messages.create({
    model: 'claude-sonnet-4-5-20250929',
    max_tokens: 4096,
    system: `You are a financial assistant for Budget Buddy app. User ID: ${userId}`,
    tools: TOOLS,
    messages: [{ role: 'user', content: message }]
  });
  
  return response;
}
---

–¢–†–ï–ë–û–í–ê–ù–ò–Ø:
- –í—Å–µ —Ñ–∞–π–ª—ã <200 —Å—Ç—Ä–æ–∫ (Junior-Friendly)
- TypeScript strict mode
- –ù–µ—Ç LSP –æ—à–∏–±–æ–∫
- –ù–µ —Ç—Ä–æ–≥–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥

–†–ï–ó–£–õ–¨–¢–ê–¢:
‚úÖ –ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ–∑–¥–∞–Ω–∞
‚úÖ TOOLS –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã
‚úÖ Executor –≥–æ—Ç–æ–≤ (–ø–æ–∫–∞ —Å –∑–∞–≥–ª—É—à–∫–æ–π)
‚úÖ Chat –∏—Å–ø–æ–ª—å–∑—É–µ—Ç BYOK (settings.anthropicApiKey)

üéØ –®–ê–ì 2: –ü–ï–†–í–´–ô TOOL (0.5 –î–ù–Ø)
–ó–∞–¥–∞—á–∞ –¥–ª—è Replit:
–†–µ–∞–ª–∏–∑—É–π –ø–µ—Ä–≤—ã–π —Ä–∞–±–æ—á–∏–π tool: get_balance

–§–ê–ô–õ–´ (1 —Ñ–∞–π–ª, 50 —Å—Ç—Ä–æ–∫):

1. server/ai/handlers/balance-handler.ts:
---
import { repositories } from '../../repositories';
import { ToolResult } from '../tool-types';

export async function handleGetBalance(
  userId: number
): Promise<ToolResult> {
  try {
    // –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∫–æ—à–µ–ª—å–∫–∏ —é–∑–µ—Ä–∞
    const wallets = await repositories.wallets.findByUser(userId);
    
    // –ü–æ—Å—á–∏—Ç–∞—Ç—å –æ–±—â–∏–π –±–∞–ª–∞–Ω—Å –≤ USD
    const totalBalance = wallets.reduce(
      (sum, wallet) => sum + (wallet.balanceUsd || 0),
      0
    );
    
    // –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
    const walletCount = wallets.length;
    const activeWallets = wallets.filter(w => w.isActive).length;
    
    return {
      success: true,
      data: {
        balance: totalBalance,
        currency: 'USD',
        wallets: walletCount,
        activeWallets: activeWallets,
        formatted: `$${totalBalance.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`
      }
    };
  } catch (error: any) {
    return {
      success: false,
      error: error.message
    };
  }
}
---

2. –û–±–Ω–æ–≤–∏—Ç—å server/ai/tool-executor.ts:
---
–ó–∞–º–µ–Ω–∏—Ç—å –∑–∞–≥–ª—É—à–∫—É –≤ case 'get_balance':
import { handleGetBalance } from './handlers/balance-handler';

case 'get_balance':
  return await handleGetBalance(userId);
---

–¢–ï–°–¢:
–î–æ–±–∞–≤–∏—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã–π endpoint –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:

router.get('/api/ai/test-balance', async (req, res) => {
  const userId = req.user!.id;
  const result = await executeTool('get_balance', {}, userId);
  res.json(result);
});

–ü—Ä–æ–≤–µ—Ä–∏—Ç—å: curl /api/ai/test-balance
–î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å: { success: true, data: { balance: ..., wallets: ... } }

–¢–†–ï–ë–û–í–ê–ù–ò–Ø:
- –§–∞–π–ª <200 —Å—Ç—Ä–æ–∫
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å repositories (–Ω–µ –ø—Ä—è–º—ã–µ SQL)
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫