ШАГ 18: ДОБАВИТЬ EXCHANGE RATE SERVICE (если нет)
typescript═══════════════════════════════════════════════════════
ЗАДАЧА: Сервис конвертации валют (если ещё нет)
ФАЙЛ: server/services/exchange-rate.service.ts
СТРОК: ~60
═══════════════════════════════════════════════════════

ПРОВЕРЬ: Есть ли уже файл server/services/exchange-rate.service.ts?

ЕСЛИ ДА - ПРОПУСТИ ЭТОТ ШАГ ✅

ЕСЛИ НЕТ - СОЗДАЙ ФАЙЛ: server/services/exchange-rate.service.ts

СОДЕРЖИМОЕ:

interface ExchangeRates {
  USD: number;
  RUB: number;
  IDR: number;
}

let cachedRates: ExchangeRates | null = null;
let lastFetch: number = 0;
const CACHE_DURATION = 60 * 60 * 1000; // 1 час

export class ExchangeRateService {
  
  async getRates(): Promise<ExchangeRates> {
    const now = Date.now();
    
    // Если есть кеш и он свежий - вернуть
    if (cachedRates && (now - lastFetch) < CACHE_DURATION) {
      return cachedRates;
    }
    
    try {
      // Получить курсы от API
      const response = await fetch('https://api.exchangerate-api.com/v4/latest/USD');
      const data = await response.json();
      
      cachedRates = {
        USD: 1,
        RUB: data.rates.RUB || 90,
        IDR: data.rates.IDR || 15000
      };
      
      lastFetch = now;
      return cachedRates;
    } catch (error) {
      console.error('Failed to fetch exchange rates:', error);
      
      // Вернуть кеш или дефолтные значения
      return cachedRates || {
        USD: 1,
        RUB: 90,
        IDR: 15000
      };
    }
  }
  
  async convertToUSD(amount: number, fromCurrency: string): Promise<number> {
    if (fromCurrency === 'USD') return amount;
    
    const rates = await this.getRates();
    const rate = rates[fromCurrency as keyof ExchangeRates];
    
    if (!rate) {
      console.warn(`Unknown currency: ${fromCurrency}`);
      return amount;
    }
    
    return amount / rate;
  }
}

export const exchangeRateService = new ExchangeRateService();

ПРОВЕРКА:
✅ Файл создан (или уже существует)
✅ Сервис конвертирует валюты
✅ Кеширование работает