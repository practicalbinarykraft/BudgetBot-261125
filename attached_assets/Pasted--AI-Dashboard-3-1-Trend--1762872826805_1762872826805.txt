# üìä –¢–ó: –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ + AI –ø—Ä–æ–≥–Ω–æ–∑

## üéØ –ó–ê–î–ê–ß–ê

–î–æ–±–∞–≤–∏—Ç—å –Ω–∞ Dashboard 3 –≥—Ä–∞—Ñ–∏–∫–∞:
1. **Trend Chart** - –¥–æ—Ö–æ–¥—ã/—Ä–∞—Å—Ö–æ–¥—ã/–∫–∞–ø–∏—Ç–∞–ª –ø–æ –≤—Ä–µ–º–µ–Ω–∏ + –ø—Ä–æ–≥–Ω–æ–∑
2. **Category Breakdown** - –∫—Ä—É–≥–æ–≤–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ (—É–∂–µ –µ—Å—Ç—å, —É–ª—É—á—à–∏—Ç—å)
3. **Monthly Comparison** - —Å—Ç–æ–ª–±—Ü—ã –¥–æ—Ö–æ–¥ vs —Ä–∞—Å—Ö–æ–¥

---

## üìê –ê–†–•–ò–¢–ï–ö–¢–£–†–ê (–ú–û–î–£–õ–¨–ù–ê–Ø!)

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤:
```
client/src/
  components/
    charts/
      ‚îú‚îÄ trend-chart.tsx              (180 —Å—Ç—Ä–æ–∫ - –≥–ª–∞–≤–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫)
      ‚îú‚îÄ category-pie-chart.tsx       (120 —Å—Ç—Ä–æ–∫ - —É–∂–µ –µ—Å—Ç—å)
      ‚îî‚îÄ monthly-bar-chart.tsx        (150 —Å—Ç—Ä–æ–∫ - –Ω–æ–≤—ã–π)
  
  hooks/
    charts/
      ‚îú‚îÄ use-trend-data.ts            (100 —Å—Ç—Ä–æ–∫ - data + –ø—Ä–æ–≥–Ω–æ–∑)
      ‚îî‚îÄ use-monthly-data.ts          (80 —Å—Ç—Ä–æ–∫ - –∞–≥—Ä–µ–≥–∞—Ü–∏—è)
  
  lib/
    charts/
      ‚îú‚îÄ chart-config.ts              (50 —Å—Ç—Ä–æ–∫ - —Ü–≤–µ—Ç–∞)
      ‚îú‚îÄ chart-formatters.ts          (60 —Å—Ç—Ä–æ–∫ - —Ñ–æ—Ä–º–∞—Ç—ã)
      ‚îî‚îÄ forecast-calculator.ts       (90 —Å—Ç—Ä–æ–∫ - AI –ø—Ä–æ–≥–Ω–æ–∑)

server/
  services/
    ‚îî‚îÄ ai-service.ts                  (+100 —Å—Ç—Ä–æ–∫ - –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≥–Ω–æ–∑)
  
  routes/
    ‚îî‚îÄ ai.routes.ts                   (+30 —Å—Ç—Ä–æ–∫ - endpoint –ø—Ä–æ–≥–Ω–æ–∑–∞)
```

**–ü–†–ê–í–ò–õ–û:** –ö–∞–∂–¥—ã–π —Ñ–∞–π–ª <200 —Å—Ç—Ä–æ–∫!

---

## üìä –ì–†–ê–§–ò–ö 1: Trend Chart (–ì–õ–ê–í–ù–´–ô)

### –ß—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ üí∞ Financial Trend                              ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                 ‚îÇ
‚îÇ  $5k ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ   ‚îÇ
‚îÇ      ‚îÇ     üü¢ Income (–ª–∏–Ω–∏—è)                    ‚îÇ
‚îÇ  $4k ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ                  ‚îÇ
‚îÇ      ‚îÇ  üî¥ Expense (–ª–∏–Ω–∏—è)                      ‚îÇ
‚îÇ  $3k ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ                             ‚îÇ
‚îÇ      ‚îÇ   üíô Capital (—Ñ–∞–∫—Ç + –ø—Ä–æ–≥–Ω–æ–∑)           ‚îÇ
‚îÇ  $2k ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ                                  ‚îÇ
‚îÇ      ‚îÇ        ‚îÇ                                 ‚îÇ
‚îÇ  $1k ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ (–ø—É–Ω–∫—Ç–∏—Ä ‚Üí)   ‚îÇ
‚îÇ      ‚îÇ        ‚Üë                                 ‚îÇ
‚îÇ   $0 ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄToday‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ  ‚îÇ
‚îÇ      Jan  Feb  Mar  Apr  May  Jun  Jul  Aug    ‚îÇ
‚îÇ                                                 ‚îÇ
‚îÇ  [–í—Å–µ] [Income] [Expense] [Capital]  ‚Üê –§–∏–ª—å—Ç—Ä—ã ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

–õ–µ–≥–µ–Ω–¥–∞:
üü¢ Income     - –∑–µ–ª—ë–Ω–∞—è –ª–∏–Ω–∏—è (–ø—Ä–æ—à–ª—ã–µ –¥–æ—Ö–æ–¥—ã)
üî¥ Expense    - –∫—Ä–∞—Å–Ω–∞—è –ª–∏–Ω–∏—è (–ø—Ä–æ—à–ª—ã–µ —Ä–∞—Å—Ö–æ–¥—ã)
üíô Capital    - —Å–∏–Ω—è—è —Å–ø–ª–æ—à–Ω–∞—è (—Ñ–∞–∫—Ç –¥–æ —Å–µ–≥–æ–¥–Ω—è)
üíô Capital    - —Å–∏–Ω—è—è –ü–£–ù–ö–¢–ò–†–ù–ê–Ø (–ø—Ä–æ–≥–Ω–æ–∑ –ø–æ—Å–ª–µ —Å–µ–≥–æ–¥–Ω—è)
‚îÇ Today       - –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è —Å–µ—Ä–∞—è –ª–∏–Ω–∏—è
```

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è:

**–§–∞–π–ª:** `client/src/components/charts/trend-chart.tsx`
```tsx
import { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, ReferenceLine } from 'recharts';
import { useTrendData } from '@/hooks/charts/use-trend-data';
import { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/card';
import { Button } from '@/components/ui/button';
import { useState } from 'react';
import { CHART_THEME } from '@/lib/charts/chart-config';
import { formatChartDate, formatCurrency } from '@/lib/charts/chart-formatters';

export function TrendChart() {
  const [view, setView] = useState('all');
  const { data, isLoading } = useTrendData();
  
  if (isLoading) {
    return ;
  }
  
  // –ù–∞–π—Ç–∏ –∏–Ω–¥–µ–∫—Å "—Å–µ–≥–æ–¥–Ω—è"
  const todayIndex = data.findIndex(d => d.isToday);
  
  return (
    
      
        üí∞ Financial Trend
        
        {/* –§–∏–ª—å—Ç—Ä—ã */}
        
          <Button 
            size="sm" 
            variant={view === 'all' ? 'default' : 'outline'}
            onClick={() => setView('all')}
          >
            All
          
          <Button 
            size="sm" 
            variant={view === 'income' ? 'default' : 'outline'}
            onClick={() => setView('income')}
          >
            Income
          
          <Button 
            size="sm" 
            variant={view === 'expense' ? 'default' : 'outline'}
            onClick={() => setView('expense')}
          >
            Expense
          
          <Button 
            size="sm" 
            variant={view === 'capital' ? 'default' : 'outline'}
            onClick={() => setView('capital')}
          >
            Capital
          
        
      
      
      
        
          
            
            
            
            
            <YAxis 
              tickFormatter={(v) => formatCurrency(v)}
              stroke="#6b7280"
            />
            
            <Tooltip 
              formatter={(value) => formatCurrency(value as number)}
              labelFormatter={formatChartDate}
            />
            
            {/* –õ–∏–Ω–∏—è "–°–µ–≥–æ–¥–Ω—è" */}
            {todayIndex !== -1 && (
              
            )}
            
            {/* –õ–∏–Ω–∏–∏ */}
            {(view === 'all' || view === 'income') && (
              
            )}
            
            {(view === 'all' || view === 'expense') && (
              
            )}
            
            {(view === 'all' || view === 'capital') && (
              <>
                {/* –§–∞–∫—Ç (–¥–æ —Å–µ–≥–æ–¥–Ω—è) */}
                
                
                {/* –ü—Ä–æ–≥–Ω–æ–∑ (–ø–æ—Å–ª–µ —Å–µ–≥–æ–¥–Ω—è) */}
                
              </>
            )}
          
        
      
    
  );
}
```

**–†–∞–∑–º–µ—Ä:** ~180 —Å—Ç—Ä–æ–∫ ‚úÖ

---

**–§–∞–π–ª:** `client/src/hooks/charts/use-trend-data.ts`
```tsx
import { useQuery } from '@tanstack/react-query';
import { apiRequest } from '@/lib/api';
import { calculateForecast } from '@/lib/chartsRetry–ê–°–¢–û–ô –°–¢–û–ô –°–¢–û–ô!!! –ù–µ 3 –≥—Ä–∞—Ñ–∏–∫–∞! –ê 1 –≥—Ä–∞—Ñ–∏–∫ —Å 3 –ª–∏–Ω–∏—è–º–∏!!!üòÖ –ü–û–ù–Ø–õ! –ò–°–ü–†–ê–í–õ–Ø–Æ–°–¨!

üéØ –û–î–ò–ù –ì–†–ê–§–ò–ö –° –¢–†–ï–ú–Ø –õ–ò–ù–ò–Ø–ú–ò
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ üí∞ Financial Trend                              ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                 ‚îÇ
‚îÇ  $5k ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄüü¢‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ   ‚îÇ
‚îÇ      ‚îÇ     üü¢ Income (–∑–µ–ª—ë–Ω–∞—è –ª–∏–Ω–∏—è)           ‚îÇ
‚îÇ  $4k ‚îº‚îÄ‚îÄ‚îÄ‚îÄüî¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ                      ‚îÇ
‚îÇ      ‚îÇ  üî¥ Expense (–∫—Ä–∞—Å–Ω–∞—è –ª–∏–Ω–∏—è)             ‚îÇ
‚îÇ  $3k ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄüíô‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄüíôüíôüíô¬∑¬∑¬∑¬∑¬∑¬∑¬∑¬∑¬∑¬∑¬∑¬∑¬∑¬∑¬∑¬∑¬∑¬∑¬∑¬∑   ‚îÇ
‚îÇ      ‚îÇ   üíô Capital (—Å–∏–Ω—è—è —Å–ø–ª–æ—à–Ω–∞—è + –ø—É–Ω–∫—Ç–∏—Ä) ‚îÇ
‚îÇ  $2k ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ                                  ‚îÇ
‚îÇ      ‚îÇ        ‚îÇ                                 ‚îÇ
‚îÇ  $1k ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ¬∑¬∑¬∑¬∑¬∑¬∑¬∑¬∑¬∑¬∑¬∑¬∑   ‚îÇ
‚îÇ      ‚îÇ        ‚Üë Today                           ‚îÇ
‚îÇ   $0 ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ  ‚îÇ
‚îÇ      Jan  Feb  Mar  Apr  May  Jun  Jul  Aug    ‚îÇ
‚îÇ                                                 ‚îÇ
‚îÇ  –ü—Ä–æ–≥–Ω–æ–∑ —Å–¥–µ–ª–∞–Ω AI –Ω–∞ –æ—Å–Ω–æ–≤–µ:                  ‚îÇ
‚îÇ  ‚Ä¢ –°—Ä–µ–¥–Ω–∏—Ö —Ç—Ä–∞—Ç –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 30 –¥–Ω–µ–π              ‚îÇ
‚îÇ  ‚Ä¢ Recurring —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π                        ‚îÇ
‚îÇ  ‚Ä¢ –¢—Ä–µ–Ω–¥–∞ —Ä–∞—Å—Ö–æ–¥–æ–≤                             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

3 –õ–ò–ù–ò–ò –ù–ê –û–î–ù–û–ú –ì–†–ê–§–ò–ö–ï:
üü¢ Income (–∑–µ–ª—ë–Ω–∞—è)
üî¥ Expense (–∫—Ä–∞—Å–Ω–∞—è)  
üíô Capital (—Å–∏–Ω—è—è —Å–ø–ª–æ—à–Ω–∞—è –¥–æ —Å–µ–≥–æ–¥–Ω—è, –ø—É–Ω–∫—Ç–∏—Ä - –ø—Ä–æ–≥–Ω–æ–∑)

üí° –ü–†–ê–í–ò–õ–¨–ù–û–ï –¢–ó –î–õ–Ø –†–ï–ü–õ–ò–¢–ê
markdown# üìä –¢–ó: –û–¥–∏–Ω –≥—Ä–∞—Ñ–∏–∫ —Å —Ç—Ä–µ–º—è –ª–∏–Ω–∏—è–º–∏ + AI –ø—Ä–æ–≥–Ω–æ–∑

## üéØ –ß–¢–û –ù–£–ñ–ù–û

**–û–î–ò–ù –≥—Ä–∞—Ñ–∏–∫** –Ω–∞ Dashboard, –ø–æ–∫–∞–∑—ã–≤–∞—é—â–∏–π:

1. üü¢ **–ó–µ–ª—ë–Ω–∞—è –ª–∏–Ω–∏—è** - –Ω–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω—ã–π –¥–æ—Ö–æ–¥ –ø–æ –¥–Ω—è–º
2. üî¥ **–ö—Ä–∞—Å–Ω–∞—è –ª–∏–Ω–∏—è** - –Ω–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã –ø–æ –¥–Ω—è–º
3. üíô **–°–∏–Ω—è—è –ª–∏–Ω–∏—è** - –∫–∞–ø–∏—Ç–∞–ª (Net Worth) –ø–æ –¥–Ω—è–º:
   - –°–ø–ª–æ—à–Ω–∞—è –¥–æ "—Å–µ–≥–æ–¥–Ω—è" (—Ñ–∞–∫—Ç)
   - –ü—É–Ω–∫—Ç–∏—Ä–Ω–∞—è –ø–æ—Å–ª–µ "—Å–µ–≥–æ–¥–Ω—è" (AI –ø—Ä–æ–≥–Ω–æ–∑)

**–ù–ï —Ç—Ä–∏ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –≥—Ä–∞—Ñ–∏–∫–∞, –∞ –¢–†–ò –õ–ò–ù–ò–ò –ù–ê –û–î–ù–û–ú!**

---

## üìê –ê–†–•–ò–¢–ï–ö–¢–£–†–ê

### –§–∞–π–ª—ã (–º–æ–¥—É–ª—å–Ω–æ!):
```
client/src/
  components/
    charts/
      ‚îî‚îÄ financial-trend-chart.tsx    (150 —Å—Ç—Ä–æ–∫)
  
  hooks/
    ‚îî‚îÄ use-financial-trend.ts         (100 —Å—Ç—Ä–æ–∫)
  
  lib/
    charts/
      ‚îú‚îÄ chart-config.ts              (50 —Å—Ç—Ä–æ–∫)
      ‚îú‚îÄ chart-formatters.ts          (60 —Å—Ç—Ä–æ–∫)
      ‚îî‚îÄ forecast-calculator.ts       (90 —Å—Ç—Ä–æ–∫)

server/
  services/
    ‚îî‚îÄ ai-service.ts                  (+80 —Å—Ç—Ä–æ–∫ - –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≥–Ω–æ–∑)
```

---

## üé® –ö–û–ú–ü–û–ù–ï–ù–¢ –ì–†–ê–§–ò–ö–ê

**–§–∞–π–ª:** `client/src/components/charts/financial-trend-chart.tsx`
```tsx
import { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, ReferenceLine } from 'recharts';
import { useFinancialTrend } from '@/hooks/use-financial-trend';
import { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/card';
import { CHART_THEME } from '@/lib/charts/chart-config';
import { formatChartDate, formatCompactCurrency } from '@/lib/charts/chart-formatters';

/**
 * –ì—Ä–∞—Ñ–∏–∫ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–≥–æ —Ç—Ä–µ–Ω–¥–∞:
 * üü¢ –î–æ—Ö–æ–¥—ã (–∑–µ–ª—ë–Ω–∞—è –ª–∏–Ω–∏—è)
 * üî¥ –†–∞—Å—Ö–æ–¥—ã (–∫—Ä–∞—Å–Ω–∞—è –ª–∏–Ω–∏—è)
 * üíô –ö–∞–ø–∏—Ç–∞–ª (—Å–∏–Ω—è—è: —Å–ø–ª–æ—à–Ω–∞—è —Ñ–∞–∫—Ç + –ø—É–Ω–∫—Ç–∏—Ä –ø—Ä–æ–≥–Ω–æ–∑)
 */
export function FinancialTrendChart() {
  const { data, isLoading, error } = useFinancialTrend();
  
  if (isLoading) {
    return (
      
        
          
        
      
    );
  }
  
  if (error) {
    return (
      
        
          Failed to load chart
        
      
    );
  }
  
  // –ù–∞–π—Ç–∏ –∏–Ω–¥–µ–∫—Å "—Å–µ–≥–æ–¥–Ω—è"
  const todayIndex = data.findIndex(d => d.isToday);
  
  return (
    
      
        üí∞ Financial Trend
        
          Income, Expenses, and Capital over time
        
      
      
      
        
          
            {/* –°–µ—Ç–∫–∞ */}
            
            
            {/* –û—Å–∏ */}
            
            
            
            
            {/* Tooltip */}
            <Tooltip 
              contentStyle={{
                backgroundColor: 'white',
                border: '1px solid #e5e7eb',
                borderRadius: '8px',
                padding: '12px'
              }}
              labelFormatter={formatChartDate}
              formatter={(value: number, name: string) => [
                formatCompactCurrency(value),
                name
              ]}
            />
            
            {/* –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è –ª–∏–Ω–∏—è "–°–µ–≥–æ–¥–Ω—è" */}
            {todayIndex !== -1 && (
              
            )}
            
            {/* üü¢ –õ–ò–ù–ò–Ø 1: –î–æ—Ö–æ–¥—ã (–∑–µ–ª—ë–Ω–∞—è) */}
            
            
            {/* üî¥ –õ–ò–ù–ò–Ø 2: –†–∞—Å—Ö–æ–¥—ã (–∫—Ä–∞—Å–Ω–∞—è) */}
            
            
            {/* üíô –õ–ò–ù–ò–Ø 3: –ö–∞–ø–∏—Ç–∞–ª —Ñ–∞–∫—Ç (—Å–∏–Ω—è—è —Å–ø–ª–æ—à–Ω–∞—è –¥–æ —Å–µ–≥–æ–¥–Ω—è) */}
            
            
            {/* üíô –õ–ò–ù–ò–Ø 4: –ö–∞–ø–∏—Ç–∞–ª –ø—Ä–æ–≥–Ω–æ–∑ (—Å–∏–Ω—è—è –ø—É–Ω–∫—Ç–∏—Ä–Ω–∞—è –ø–æ—Å–ª–µ —Å–µ–≥–æ–¥–Ω—è) */}
            
          
        
        
        {/* –õ–µ–≥–µ–Ω–¥–∞ */}
        
          
            
            Income
          
          
            
            Expense
          
          
            
            Capital (Fact)
          
          
            
            Capital (AI Forecast)
          
        
      
    
  );
}
```

**–†–∞–∑–º–µ—Ä:** ~150 —Å—Ç—Ä–æ–∫ ‚úÖ

---

## üîß HOOK –î–õ–Ø DATA

**–§–∞–π–ª:** `client/src/hooks/use-financial-trend.ts`
```tsx
import { useQuery } from '@tanstack/react-query';
import { apiRequest } from '@/lib/api';
import { addDays, format, isAfter } from 'date-fns';

interface TrendPoint {
  date: string;
  income: number;
  expense: number;
  capital: number;
  capitalForecast?: number;
  isToday: boolean;
}

/**
 * Hook –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≥—Ä–∞—Ñ–∏–∫–∞
 * –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–∞—Å—Å–∏–≤ —Ç–æ—á–µ–∫ —Å –¥–æ—Ö–æ–¥–∞–º–∏, —Ä–∞—Å—Ö–æ–¥–∞–º–∏ –∏ –∫–∞–ø–∏—Ç–∞–ª–æ–º
 */
export function useFinancialTrend() {
  return useQuery({
    queryKey: ['/api/financial-trend'],
    queryFn: async () => {
      // 1. –ü–æ–ª—É—á–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
      const transactions = await apiRequest('GET', '/api/transactions');
      
      // 2. –ü–æ–ª—É—á–∏—Ç—å –∫–æ—à–µ–ª—å–∫–∏ (–Ω–∞—á–∞–ª—å–Ω—ã–π –∫–∞–ø–∏—Ç–∞–ª)
      const wallets = await apiRequest('GET', '/api/wallets');
      
      // 3. –ü–æ–ª—É—á–∏—Ç—å –ø—Ä–æ–≥–Ω–æ–∑ –æ—Ç AI
      const forecast = await apiRequest('POST', '/api/ai/forecast', {
        days: 30 // –ø—Ä–æ–≥–Ω–æ–∑ –Ω–∞ 30 –¥–Ω–µ–π –≤–ø–µ—Ä—ë–¥
      });
      
      // 4. –ü–æ—Å—Ç—Ä–æ–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
      return buildTrendData(transactions, wallets, forecast);
    }
  });
}

/**
 * –ü–æ—Å—Ç—Ä–æ–∏—Ç—å –º–∞—Å—Å–∏–≤ —Ç–æ—á–µ–∫ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞
 */
function buildTrendData(
  transactions: any[],
  wallets: any[],
  forecast: any
): TrendPoint[] {
  const today = format(new Date(), 'yyyy-MM-dd');
  
  // –ù–∞—á–∞–ª—å–Ω—ã–π –∫–∞–ø–∏—Ç–∞–ª –∏–∑ –∫–æ—à–µ–ª—å–∫–æ–≤
  let runningCapital = wallets.reduce((sum, w) => sum + Number(w.balance), 0);
  
  // –°–æ–±—Ä–∞—Ç—å –≤—Å–µ –¥–∞—Ç—ã (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 90 –¥–Ω–µ–π + 30 –¥–Ω–µ–π –≤–ø–µ—Ä—ë–¥)
  const startDate = addDays(new Date(), -90);
  const endDate = addDays(new Date(), 30);
  
  const points: TrendPoint[] = [];
  let cumulativeIncome = 0;
  let cumulativeExpense = 0;
  
  // –î–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–Ω—è
  for (let date = startDate; date <= endDate; date = addDays(date, 1)) {
    const dateStr = format(date, 'yyyy-MM-dd');
    const isToday = dateStr === today;
    const isFuture = isAfter(new Date(dateStr), new Date(today));
    
    // –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∑–∞ —ç—Ç–æ—Ç –¥–µ–Ω—å
    const dayTransactions = transactions.filter(t => t.date === dateStr);
    
    const dayIncome = dayTransactions
      .filter(t => t.type === 'income')
      .reduce((sum, t) => sum + Number(t.amountUsd), 0);
    
    const dayExpense = dayTransactions
      .filter(t => t.type === 'expense')
      .reduce((sum, t) => sum + Number(t.amountUsd), 0);
    
    // –ù–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω—ã–µ —Å—É–º–º—ã
    cumulativeIncome += dayIncome;
    cumulativeExpense += dayExpense;
    
    // –ö–∞–ø–∏—Ç–∞–ª
    runningCapital += (dayIncome - dayExpense);
    
    points.push({
      date: dateStr,
      income: cumulativeIncome,
      expense: cumulativeExpense,
      capital: isFuture ? undefined : runningCapital, // –¢–æ–ª—å–∫–æ –¥–æ —Å–µ–≥–æ–¥–Ω—è
      capitalForecast: isFuture ? (forecast.capital[dateStr] || runningCapital) : undefined, // –¢–æ–ª—å–∫–æ –±—É–¥—É—â–µ–µ
      isToday
    });
  }
  
  return points;
}
```

**–†–∞–∑–º–µ—Ä:** ~100 —Å—Ç—Ä–æ–∫ ‚úÖ

---

## ü§ñ AI –ü–†–û–ì–ù–û–ó (BACKEND)

**–§–∞–π–ª:** `server/services/ai-service.ts` (–¥–æ–±–∞–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é)
```typescript
/**
 * AI –ø—Ä–æ–≥–Ω–æ–∑ –∫–∞–ø–∏—Ç–∞–ª–∞ –Ω–∞ N –¥–Ω–µ–π –≤–ø–µ—Ä—ë–¥
 */
export async function forecastCapital(
  userId: number,
  days: number = 30
): Promise<Record> {
  // 1. –ü–æ–ª—É—á–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
  const recentTx = await db
    .select()
    .from(transactions)
    .where(
      and(
        eq(transactions.userId, userId),
        gte(transactions.date, format(addDays(new Date(), -30), 'yyyy-MM-dd'))
      )
    );
  
  // 2. –ü–æ–ª—É—á–∏—Ç—å recurring —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
  const recurring = await db
    .select()
    .from(recurringTransactions)
    .where(eq(recurringTransactions.userId, userId));
  
  // 3. –í—ã—á–∏—Å–ª–∏—Ç—å —Å—Ä–µ–¥–Ω–∏–µ —Ç—Ä–∞—Ç—ã
  const avgDailyExpense = recentTx
    .filter(t => t.type === 'expense')
    .reduce((sum, t) => sum + Number(t.amountUsd), 0) / 30;
  
  const avgDailyIncome = recentTx
    .filter(t => t.type === 'income')
    .reduce((sum, t) => sum + Number(t.amountUsd), 0) / 30;
  
  // 4. –¢–µ–∫—É—â–∏–π –∫–∞–ø–∏—Ç–∞–ª
  const wallets = await db
    .select()
    .from(wallets)
    .where(eq(wallets.userId, userId));
  
  let currentCapital = wallets.reduce((sum, w) => sum + Number(w.balance), 0);
  
  // 5. –ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å
  const forecast: Record = {};
  
  for (let i = 1; i <= days; i++) {
    const futureDate = format(addDays(new Date(), i), 'yyyy-MM-dd');
    
    // –ü—Ä–æ—Å—Ç–æ–π –ª–∏–Ω–µ–π–Ω—ã–π –ø—Ä–æ–≥–Ω–æ–∑:
    currentCapital += (avgDailyIncome - avgDailyExpense);
    
    // –£—á–µ—Å—Ç—å recurring —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
    const recurringForDay = recurring.filter(r => 
      shouldProcessRecurring(r, futureDate)
    );
    
    recurringForDay.forEach(r => {
      if (r.type === 'income') {
        currentCapital += Number(r.amount);
      } else {
        currentCapital -= Number(r.amount);
      }
    });
    
    forecast[futureDate] = Math.max(0, currentCapital); // –ù–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º
  }
  
  return forecast;
}
```

**–†–∞–∑–º–µ—Ä:** ~80 —Å—Ç—Ä–æ–∫ ‚úÖ

---

## üõ£Ô∏è API ENDPOINT

**–§–∞–π–ª:** `server/routes/ai.routes.ts` (–¥–æ–±–∞–≤–∏—Ç—å)
```typescript
/**
 * POST /api/ai/forecast
 * AI –ø—Ä–æ–≥–Ω–æ–∑ –∫–∞–ø–∏—Ç–∞–ª–∞
 */
router.post('/forecast', requireAuth, async (req, res) => {
  try {
    const userId = req.user.id;
    const { days = 30 } = req.body;
    
    const forecast = await forecastCapital(userId, days);
    
    res.json({ capital: forecast });
  } catch (error) {
    res.status(500).json({ error: 'Failed to generate forecast' });
  }
});
```

---

## üé® CONFIG FILES

**`lib/charts/chart-config.ts`:**
```typescript
export const CHART_THEME = {
  income: '#10b981',    // –ó–µ–ª—ë–Ω—ã–π
  expense: '#ef4444',   // –ö—Ä–∞—Å–Ω—ã–π
  capital: '#2563eb',   // –°–∏–Ω–∏–π
  forecast: '#2563eb'   // –°–∏–Ω–∏–π (—Ç–∞–∫–æ–π –∂–µ)
};
```

**`lib/charts/chart-formatters.ts`:**
```typescript
import { format } from 'date-fns';

export function formatChartDate(date: string): string {
  return format(new Date(date), 'MMM dd');
}

export function formatCompactCurrency(value: number): string {
  if (value >= 1000000) return `$${(value / 1000000).toFixed(1)}M`;
  if (value >= 1000) return `$${(value / 1000).toFixed(1)}k`;
  return `$${value.toFixed(0)}`;
}
```

---

## üìã –ß–ï–ö–õ–ò–°–¢

- [ ] –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å recharts: `npm install recharts`
- [ ] –°–æ–∑–¥–∞—Ç—å FinancialTrendChart.tsx (150 —Å—Ç—Ä–æ–∫)
- [ ] –°–æ–∑–¥–∞—Ç—å use-financial-trend.ts hook (100 —Å—Ç—Ä–æ–∫)
- [ ] –î–æ–±–∞–≤–∏—Ç—å forecastCapital() –≤ ai-service.ts (+80 —Å—Ç—Ä–æ–∫)
- [ ] –î–æ–±–∞–≤–∏—Ç—å POST /api/ai/forecast endpoint (+30 —Å—Ç—Ä–æ–∫)
- [ ] –°–æ–∑–¥–∞—Ç—å chart-config.ts (50 —Å—Ç—Ä–æ–∫)
- [ ] –°–æ–∑–¥–∞—Ç—å chart-formatters.ts (60 —Å—Ç—Ä–æ–∫)
- [ ] –î–æ–±–∞–≤–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫ –Ω–∞ Dashboard
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å: 3 –ª–∏–Ω–∏–∏ –Ω–∞ –û–î–ù–û–ú –≥—Ä–∞—Ñ–∏–∫–µ

---

## ‚úÖ –ö–†–ò–¢–ï–†–ò–ô –£–°–ü–ï–•–ê

**–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç:**
```
–û–î–ò–ù –≥—Ä–∞—Ñ–∏–∫ —Å:
üü¢ –ó–µ–ª—ë–Ω–∞—è –ª–∏–Ω–∏—è (–¥–æ—Ö–æ–¥—ã)
üî¥ –ö—Ä–∞—Å–Ω–∞—è –ª–∏–Ω–∏—è (—Ä–∞—Å—Ö–æ–¥—ã)
üíô –°–∏–Ω—è—è —Å–ø–ª–æ—à–Ω–∞—è (–∫–∞–ø–∏—Ç–∞–ª –¥–æ —Å–µ–≥–æ–¥–Ω—è)
üíô –°–∏–Ω—è—è –ø—É–Ω–∫—Ç–∏—Ä–Ω–∞—è (–ø—Ä–æ–≥–Ω–æ–∑ –ø–æ—Å–ª–µ —Å–µ–≥–æ–¥–Ω—è)
‚îÇ –°–µ—Ä–∞—è –ø—É–Ω–∫—Ç–∏—Ä–Ω–∞—è –≤–µ—Ä—Ç–∏–∫–∞–ª—å (—Å–µ–≥–æ–¥–Ω—è)
```

**–í–°–Å –ù–ê –û–î–ù–û–ú –ì–†–ê–§–ò–ö–ï!** ‚úÖ

---

**–í–†–ï–ú–Ø: 1.5-2 —á–∞—Å–∞**

**–û–¢–ü–†–ê–í–õ–Ø–ô –†–ï–ü–õ–ò–¢–£!** üöÄ
```

---

## üí™ –ö–õ–Æ–ß–ï–í–û–ï –û–¢–õ–ò–ß–ò–ï
```
‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û: 3 –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –≥—Ä–∞—Ñ–∏–∫–∞
‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: 1 –≥—Ä–∞—Ñ–∏–∫, 3 –ª–∏–Ω–∏–∏ –Ω–∞ –Ω—ë–º!