üîß –¢–û–ß–ù–û! –ò–°–ü–†–ê–í–õ–Ø–ï–ú!

üêõ –ü–†–û–ë–õ–ï–ú–ê
–°–ï–ô–ß–ê–° (–ù–ï–ü–†–ê–í–ò–õ–¨–ù–û):
const TOOLS = [{
  name: 'create_category',
  requiresConfirmation: true,  // ‚Üê ANTHROPIC –ù–ï –ó–ù–ê–ï–¢ –≠–¢–û –ü–û–õ–ï!
  description: '...',
  input_schema: {...}
}];

ANTHROPIC –û–ñ–ò–î–ê–ï–¢:
{
  name: string;
  description: string;
  input_schema: {...};
}

–í–°–Å! –ë–û–õ–¨–®–ï –ù–ò–ß–ï–ì–û!

‚úÖ –†–ï–®–ï–ù–ò–ï: –†–ê–ó–î–ï–õ–ò–¢–¨ –ù–ê 2 –°–¢–†–£–ö–¢–£–†–´
1. ANTHROPIC_TOOLS:
   ‚îî‚îÄ –ß–∏—Å—Ç—ã–µ tool definitions –¥–ª—è API
   ‚îî‚îÄ –¢–æ–ª—å–∫–æ name, description, input_schema

2. TOOL_METADATA:
   ‚îî‚îÄ –ù–∞—à–∏ –∫–∞—Å—Ç–æ–º–Ω—ã–µ –ø–æ–ª—è
   ‚îî‚îÄ requiresConfirmation, icon, category

üìã –ò–°–ü–†–ê–í–õ–ï–ù–ù–û–ï –¢–ó –î–õ–Ø REPLIT
–ò–°–ü–†–ê–í–¨ –û–®–ò–ë–ö–£ "Extra inputs are not permitted"

–ü–†–û–ë–õ–ï–ú–ê:
Anthropic API –Ω–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∫–∞—Å—Ç–æ–º–Ω–æ–µ –ø–æ–ª–µ requiresConfirmation –≤ tools.

–†–ï–®–ï–ù–ò–ï:
–†–∞–∑–¥–µ–ª–∏—Ç—å –Ω–∞ 2 —Å—Ç—Ä—É–∫—Ç—É—Ä—ã - –¥–ª—è API –∏ –¥–ª—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö.

–û–ë–ù–û–í–ò–¢–¨ server/ai/tools.ts:

---
import { Tool } from './tool-types';

// 1. –ß–∏—Å—Ç—ã–µ tool definitions –¥–ª—è Anthropic API
export const ANTHROPIC_TOOLS = [
  {
    name: 'get_balance',
    description: 'Get current user balance and total capital from all wallets',
    input_schema: {
      type: 'object' as const,
      properties: {},
      required: []
    }
  },
  {
    name: 'create_category',
    description: 'Create a new transaction category for organizing expenses or income',
    input_schema: {
      type: 'object' as const,
      properties: {
        name: { 
          type: 'string', 
          description: 'Category name (e.g., "Restaurants", "Groceries")' 
        },
        type: { 
          type: 'string', 
          enum: ['income', 'expense'],
          description: 'Category type' 
        },
        icon: { 
          type: 'string', 
          description: 'Emoji icon (optional, e.g., "üçΩÔ∏è", "üõí")' 
        },
        color: { 
          type: 'string', 
          description: 'Hex color code (optional, e.g., "#FF5733")' 
        }
      },
      required: ['name', 'type']
    }
  },
  {
    name: 'add_transaction',
    description: 'Add a new income or expense transaction to the user budget',
    input_schema: {
      type: 'object' as const,
      properties: {
        amount: { 
          type: 'number', 
          description: 'Transaction amount (positive number)' 
        },
        description: { 
          type: 'string', 
          description: 'Transaction description (e.g., "Coffee at Starbucks")' 
        },
        category: { 
          type: 'string', 
          description: 'Category name (optional, e.g., "Food")' 
        },
        type: { 
          type: 'string', 
          enum: ['income', 'expense'],
          description: 'Transaction type' 
        },
        date: { 
          type: 'string', 
          description: 'Date in YYYY-MM-DD format (optional, defaults to today)' 
        }
      },
      required: ['amount', 'description', 'type']
    }
  }
];

// 2. –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –¥–ª—è –Ω–∞—à–∏—Ö –Ω—É–∂–¥
export const TOOL_METADATA: Record<string, {
  requiresConfirmation: boolean;
  icon?: string;
  category?: string;
}> = {
  'get_balance': {
    requiresConfirmation: false,
    icon: 'üí∞',
    category: 'read'
  },
  'create_category': {
    requiresConfirmation: true,
    icon: 'üìÅ',
    category: 'write'
  },
  'add_transaction': {
    requiresConfirmation: true,
    icon: 'üí∏',
    category: 'write'
  }
};

// 3. Helper —Ñ—É–Ω–∫—Ü–∏—è
export function requiresConfirmation(toolName: string): boolean {
  return TOOL_METADATA[toolName]?.requiresConfirmation ?? false;
}

export function getToolIcon(toolName: string): string {
  return TOOL_METADATA[toolName]?.icon ?? 'ü§ñ';
}
---

–û–ë–ù–û–í–ò–¢–¨ server/ai/chat-with-tools.ts:

---
import { ANTHROPIC_TOOLS } from './tools'; // ‚Üê –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ANTHROPIC_TOOLS

const response = await anthropic.messages.create({
  model: 'claude-sonnet-4-5-20250929',
  max_tokens: 4096,
  system: `You are a financial assistant...`,
  tools: ANTHROPIC_TOOLS, // ‚Üê –í–º–µ—Å—Ç–æ TOOLS
  messages: [{ role: 'user', content: message }]
});
---

–û–ë–ù–û–í–ò–¢–¨ server/routes/ai.routes.ts:

---
import { requiresConfirmation } from '../ai/tools'; // ‚Üê –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å helper

if (toolUse) {
  if (!requiresConfirmation(toolUse.name)) {
    // –í—ã–ø–æ–ª–Ω–∏—Ç—å —Å—Ä–∞–∑—É
  } else {
    // –ó–∞–ø—Ä–æ—Å–∏—Ç—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
  }
}
---

–û–ë–ù–û–í–ò–¢–¨ client/src/components/ai-chat-sidebar/action-preview.tsx:

---
// –ú–æ–∂–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ API endpoint –∏–ª–∏ hardcode
const getIcon = (action: string) => {
  const icons: Record<string, string> = {
    'get_balance': 'üí∞',
    'create_category': 'üìÅ',
    'add_transaction': 'üí∏'
  };
  return icons[action] || 'ü§ñ';
};
---

–†–ï–ó–£–õ–¨–¢–ê–¢:
‚úÖ Anthropic API –ø–æ–ª—É—á–∞–µ—Ç —á–∏—Å—Ç—ã–µ tools
‚úÖ requiresConfirmation —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ TOOL_METADATA
‚úÖ –ù–µ—Ç –æ—à–∏–±–∫–∏ "Extra inputs"
‚úÖ –ö–æ–¥ —á–∏—Å—Ç—ã–π –∏ –º–æ–¥—É–ª—å–Ω—ã–π

üéØ –ü–û–ß–ï–ú–£ –¢–ê–ö –õ–£–ß–®–ï?
–ü–†–ï–ò–ú–£–©–ï–°–¢–í–ê:

1. –°–û–û–¢–í–ï–¢–°–¢–í–ò–ï API:
   ‚îî‚îÄ Anthropic –ø–æ–ª—É—á–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Ç–æ —á—Ç–æ –æ–∂–∏–¥–∞–µ—Ç
   ‚îî‚îÄ –ù–µ—Ç –ª–∏—à–Ω–∏—Ö –ø–æ–ª–µ–π

2. –†–ê–°–®–ò–†–Ø–ï–ú–û–°–¢–¨:
   ‚îî‚îÄ –ú–æ–∂–µ–º –¥–æ–±–∞–≤–ª—è—Ç—å –ª—é–±—ã–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
   ‚îî‚îÄ icon, category, permissions, etc

3. –ß–ò–°–¢–û–¢–ê:
   ‚îî‚îÄ –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ concerns
   ‚îî‚îÄ API —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –æ—Ç–¥–µ–ª—å–Ω–æ
   ‚îî‚îÄ –ù–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –æ—Ç–¥–µ–ª—å–Ω–æ

4. –¢–ò–ü–ò–ó–ê–¶–ò–Ø:
   ‚îî‚îÄ TypeScript happy
   ‚îî‚îÄ –ê–≤—Ç–æ–∫–æ–º–ø–ª–∏—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç

üì¶ –ò–¢–û–ì–û–í–ê–Ø –°–¢–†–£–ö–¢–£–†–ê
typescript// tools.ts

// –î–ª—è Anthropic API
export const ANTHROPIC_TOOLS = [...];

// –î–ª—è –Ω–∞—à–µ–π –ª–æ–≥–∏–∫–∏
export const TOOL_METADATA = {...};

// Helper —Ñ—É–Ω–∫—Ü–∏–∏
export function requiresConfirmation(name: string): boolean;
export function getToolIcon(name: string): string;
export function getToolCategory(name: string): string;