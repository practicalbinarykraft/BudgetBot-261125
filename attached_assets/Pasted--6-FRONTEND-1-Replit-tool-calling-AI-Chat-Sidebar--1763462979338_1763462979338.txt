üéØ –®–ê–ì 6: –û–ë–ù–û–í–ò–¢–¨ FRONTEND (1 –î–ï–ù–¨)
–ó–∞–¥–∞—á–∞ –¥–ª—è Replit:
–ò–Ω—Ç–µ–≥—Ä–∏—Ä—É–π tool calling –≤ AI Chat Sidebar

–û–ë–ù–û–í–ò–¢–¨ client/src/components/ai-chat-sidebar/index.tsx:

1. –î–æ–±–∞–≤–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è pending confirmation:
---
const [pendingConfirmation, setPendingConfirmation] = useState<{
  action: string;
  params: Record<string, any>;
  toolUseId: string;
} | null>(null);
---

2. –û–±–Ω–æ–≤–∏—Ç—å sendMessage —Ñ—É–Ω–∫—Ü–∏—é:
---
const sendMessage = async (text: string) => {
  if (!text.trim()) return;
  
  // –î–æ–±–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ —é–∑–µ—Ä–∞
  addMessage({ role: 'user', content: text });
  setInput('');
  
  try {
    // –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ API
    const response = await fetch('/api/ai/chat', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      credentials: 'include',
      body: JSON.stringify({ message: text })
    });
    
    const data = await response.json();
    
    if (data.type === 'tool_confirmation') {
      // –ü–æ–∫–∞–∑–∞—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
      setPendingConfirmation({
        action: data.action,
        params: data.params,
        toolUseId: data.toolUseId
      });
    } else if (data.type === 'message') {
      // –û–±—ã—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
      addMessage({ role: 'assistant', content: data.content });
    }
  } catch (error: any) {
    addMessage({ 
      role: 'assistant', 
      content: `‚ùå –û—à–∏–±–∫–∞: ${error.message}` 
    });
  }
};
---

3. –î–æ–±–∞–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è:
---
const confirmTool = async () => {
  if (!pendingConfirmation) return;
  
  try {
    const response = await fetch('/api/ai/confirm-tool', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      credentials: 'include',
      body: JSON.stringify(pendingConfirmation)
    });
    
    const data = await response.json();
    
    // –î–æ–±–∞–≤–∏—Ç—å –æ—Ç–≤–µ—Ç AI
    addMessage({ role: 'assistant', content: data.content });
    
    // –£–±—Ä–∞—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É
    setPendingConfirmation(null);
  } catch (error: any) {
    addMessage({ 
      role: 'assistant', 
      content: `‚ùå –û—à–∏–±–∫–∞: ${error.message}` 
    });
    setPendingConfirmation(null);
  }
};
---

4. –î–æ–±–∞–≤–∏—Ç—å –≤ JSX (–ø–µ—Ä–µ–¥ messages):
---
{pendingConfirmation && (
  <ConfirmationCard
    action={pendingConfirmation.action}
    params={pendingConfirmation.params}
    onConfirm={confirmTool}
    onCancel={() => {
      addMessage({ 
        role: 'assistant', 
        content: '‚ùå –î–µ–π—Å—Ç–≤–∏–µ –æ—Ç–º–µ–Ω–µ–Ω–æ' 
      });
      setPendingConfirmation(null);
    }}
  />
)}
---

–¢–†–ï–ë–û–í–ê–ù–ò–Ø:
- –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å ConfirmationCard
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- –û—Ç–º–µ–Ω–∞ –¥–µ–π—Å—Ç–≤–∏—è
- –°–æ–æ–±—â–µ–Ω–∏—è –æ–± —É—Å–ø–µ—Ö–µ/–æ—à–∏–±–∫–µ